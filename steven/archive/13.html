<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/1">
	<title>.NET Junkie - The DbTransactionWrapper</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout12.css" type="text/css" />
	<!--[if IE]>
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ie.css" type="text/css" />
	<![endif]-->
	<!--[if !IE]>-->
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ff.css" type="text/css" />
	<!--<![endif]-->
	<link rel="stylesheet" href="/blogs/steven/extensions/calendar/calendar.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/mobile.css?changed=20121020a" type="text/css" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/print.css?changed=20110919" type="text/css" media="print" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/blogs/steven/rss.xml" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/blogs/steven/atom.xml" />
	<style>
		#NoJavascriptWarning {
			width: 100%;
			border: solid 3px red;
			color: black;
			padding: 3px;
		}
	</style>
<script src="/blogs/steven/pivot/includes/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function pJCCBos(){ $('input[@name=post]').attr('disabled', ''); }
function Z(TPaGE){var dy="0123456789abcdef";var str="";for(var i=0;i<TPaGE.length*4;i++){str+=dy.charAt((TPaGE[i>>2]>>((i%4)*8+4))&0xF)+dy.charAt((TPaGE[i>>2]>>((i%4)*8))&0xF);}return str;} function ZhGXZ(a,b,c,d,x,s,t){return X((b&d)|(c&(~d)),a,b,x,s,t);} function ukLhIW(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);} function GSGgZW(a,b,c,d,x,s,t){return X(c ^(b|(~d)),a,b,x,s,t);} function mWksnxiyqpUrrrVupF(){return 27 * 27 + 38; }  function DftK(x,len){x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=JPtT(a,b,c,d,x[i+0],7,-680876936);d=JPtT(d,a,b,c,x[i+1],12,-389564586);c=JPtT(c,d,a,b,x[i+2],17,606105819);b=JPtT(b,c,d,a,x[i+3],22,-1044525330);a=JPtT(a,b,c,d,x[i+4],7,-176418897);d=JPtT(d,a,b,c,x[i+5],12,1200080426);c=JPtT(c,d,a,b,x[i+6],17,-1473231341);b=JPtT(b,c,d,a,x[i+7],22,-45705983);a=JPtT(a,b,c,d,x[i+8],7,1770035416);d=JPtT(d,a,b,c,x[i+9],12,-1958414417);c=JPtT(c,d,a,b,x[i+10],17,-42063);b=JPtT(b,c,d,a,x[i+11],22,-1990404162);a=JPtT(a,b,c,d,x[i+12],7,1804603682);d=JPtT(d,a,b,c,x[i+13],12,-40341101);c=JPtT(c,d,a,b,x[i+14],17,-1502002290);b=JPtT(b,c,d,a,x[i+15],22,1236535329);a=ZhGXZ(a,b,c,d,x[i+1],5,-165796510);d=ZhGXZ(d,a,b,c,x[i+6],9,-1069501632);c=ZhGXZ(c,d,a,b,x[i+11],14,643717713);b=ZhGXZ(b,c,d,a,x[i+0],20,-373897302);a=ZhGXZ(a,b,c,d,x[i+5],5,-701558691);d=ZhGXZ(d,a,b,c,x[i+10],9,38016083);c=ZhGXZ(c,d,a,b,x[i+15],14,-660478335);b=ZhGXZ(b,c,d,a,x[i+4],20,-405537848);a=ZhGXZ(a,b,c,d,x[i+9],5,568446438);d=ZhGXZ(d,a,b,c,x[i+14],9,-1019803690);c=ZhGXZ(c,d,a,b,x[i+3],14,-187363961);b=ZhGXZ(b,c,d,a,x[i+8],20,1163531501);a=ZhGXZ(a,b,c,d,x[i+13],5,-1444681467);d=ZhGXZ(d,a,b,c,x[i+2],9,-51403784);c=ZhGXZ(c,d,a,b,x[i+7],14,1735328473);b=ZhGXZ(b,c,d,a,x[i+12],20,-1926607734);a=I(a,b,c,d,x[i+5],4,-378558);d=I(d,a,b,c,x[i+8],11,-2022574463);c=I(c,d,a,b,x[i+11],16,1839030562);b=I(b,c,d,a,x[i+14],23,-35309556);a=I(a,b,c,d,x[i+1],4,-1530992060);d=I(d,a,b,c,x[i+4],11,1272893353);c=I(c,d,a,b,x[i+7],16,-155497632);b=I(b,c,d,a,x[i+10],23,-1094730640);a=I(a,b,c,d,x[i+13],4,681279174);d=I(d,a,b,c,x[i+0],11,-358537222);c=I(c,d,a,b,x[i+3],16,-722521979);b=I(b,c,d,a,x[i+6],23,76029189);a=I(a,b,c,d,x[i+9],4,-640364487);d=I(d,a,b,c,x[i+12],11,-421815835);c=I(c,d,a,b,x[i+15],16,530742520);b=I(b,c,d,a,x[i+2],23,-995338651);a=GSGgZW(a,b,c,d,x[i+0],6,-198630844);d=GSGgZW(d,a,b,c,x[i+7],10,1126891415);c=GSGgZW(c,d,a,b,x[i+14],15,-1416354905);b=GSGgZW(b,c,d,a,x[i+5],21,-57434055);a=GSGgZW(a,b,c,d,x[i+12],6,1700485571);d=GSGgZW(d,a,b,c,x[i+3],10,-1894986606);c=GSGgZW(c,d,a,b,x[i+10],15,-1051523);b=GSGgZW(b,c,d,a,x[i+1],21,-2054922799);a=GSGgZW(a,b,c,d,x[i+8],6,1873313359);d=GSGgZW(d,a,b,c,x[i+15],10,-30611744);c=GSGgZW(c,d,a,b,x[i+6],15,-1560198380);b=GSGgZW(b,c,d,a,x[i+13],21,1309151649);a=GSGgZW(a,b,c,d,x[i+4],6,-145523070);d=GSGgZW(d,a,b,c,x[i+11],10,-1120210379);c=GSGgZW(c,d,a,b,x[i+2],15,718787259);b=GSGgZW(b,c,d,a,x[i+9],21,-343485551);a=ukLhIW(a,olda);b=ukLhIW(b,oldb);c=ukLhIW(c,oldc);d=ukLhIW(d,oldd);}return Array(a,b,c,d);} function aRtLqWuNwxmm(s){return Z(DftK(tYGPA(s),s.length*8));} function I(a,b,c,d,x,s,t){return X(b ^ c ^ d,a,b,x,s,t);} function CeeC(num,cnt){return(num<<cnt)|(num>>>(32-cnt));} function tYGPA(AjTb){var kr=Array();var jxwwT=(1<<8)-1;for(var i=0;i<AjTb.length*8;i+=8)kr[i>>5]|=(AjTb.charCodeAt(i/8)&jxwwT)<<(i%32);return kr;} function X(q,a,b,x,s,t){return ukLhIW(CeeC(ukLhIW(ukLhIW(a,q),ukLhIW(x,t)),s),b);}function JPtT(a,b,c,d,x,s,t){return X((b&c)|((~b)&d),a,b,x,s,t);} function olbftuGcCFfi(kIUEhBlvEakajzHE){ rYsphLQZbnDFjM = document.getElementById("SYARkuESV"); if(!rYsphLQZbnDFjM){ return false; } else { rYsphLQZbnDFjM.name = aRtLqWuNwxmm(kIUEhBlvEakajzHE); rYsphLQZbnDFjM.value = mWksnxiyqpUrrrVupF(); return true; }}
$(document).ready(function(){ setTimeout("pJCCBos()", 100); });
// -->
</script>

</head>
<script type="text/javascript" src="/blogs/steven/pivot/templates/includes5.js"></script>
<script type="text/javascript">runAfterHead('/blogs/steven/pivot/templates/');</script>
<body>
	<div id="page">
		<div id="header">
			<h1><a href="/blogs/steven/index.php" title=".NET Junkie">.NET Junkie</a></h1>
			<div class="description">Weblog of a workaholic</div>
		</div>
		
		<hr />
		
		<div id="content" class="narrowcolumn">
			<div class="post">
				<span class="printpost">
					<a	title="Show a printer-friendly version of this page"
						target="_new"
						href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=13&print=true">
						<img alt="Print" src="/blogs/steven/pivot/templates/images/print.gif" />
					</a>
				</span>
				<div class="entry" id="entry">
					<span class="entrydate">06 October 06</span>
					<h3><a href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=13">The DbTransactionWrapper</a></h3>
			
					<h4>A few months ago I wrote some code for a project I was working on. It was a class that wrapped a SqlTransaction and a SqlConnection object. I named it the &ldquo;SqlTransactionWrapper&rdquo;. This class made coding easier for my colleague with whom I was working at that time. Also, I no longer needed to type a lot of code over and over again. I now rewrote the class so it fits in the more generic approach given by ADO.NET 2.0. So behold: The DbTransactionWrapper!</h4>
					
					<div id="entry_body">
						<a id="body"></a><p>The DbTransactionWrapper wraps a <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.data.common.dbtransaction.aspx" target="_blank" title=".NET Framework Class Library - DbTransaction Class ">DbTransaction</a> object. This means, it creates and opens a <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.data.common.dbconnection.aspx" target="_blank" title=".NET Framework Class Library - DbConnection Class">DbConnection</a> and creates a transaction within that connection. Within the scope of the DbTransactionWrapper you can execute your commands and in the end call DbTransactionWrapper.Commit. But in the case of an exception it will rollback the transaction for you. The user code could look like this:</p>   <pre class="cs" language="csharp" customtypes="DbTransactionWrapper DbHelper">using (DbTransactionWrapper transaction =<br />    new DbTransactionWrapper(&quot;connection string&quot;))<br />{<br />    DbHelper.ExecuteNonQuery(transaction, <br />        &quot;UPDATE SOMETHING&quot;);<br />    DbHelper.ExecuteNonQuery(transaction,<br />        &quot;DELETE SOMETHING&quot;);<br /><br />    transaction.Commit();<br />}</pre>   <p>Right now you might think, &ldquo;<span style="font-style: italic">That&rsquo;s nice, but what about the .NET 2.0 TransactionScope? It allows the above type of coding, but is much more powerful</span>&rdquo;. The <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.transactions.transactionscope.aspx" target="_blank" title=".NET Framework Class Library - TransactionScope Class">TransactionScope</a> indeed is very powerful, but it needs the Microsoft Distributed Transaction Coordinator Service, which sometimes makes it a little bit too powerful in certain situations. See the DbTransactionWrapper as a lightweight version of the TransactionScope without the overhead of the MSDTC and without the 'distributed' part :-).</p><p>Let me explain a bit about the wrapper. The DbTransactionWrapper implements <a rel="external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemIDisposableClassTopic.asp" target="_blank" title=".NET Framework Class Library - IDisposable Interface">IDisposable</a> which allows us to write the using<font color="#0000ff"> </font>statement. In case of an exception, the wrapper will detect -during disposal- that Commit was never called and rolls back the transaction.</p><p>The DbTransactionWrapper is an abstract class (like the <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.data.common.dbcommand.aspx" target="_blank" title=".NET Framework Class Library - DbCommand Class">DbCommand</a> and DbConnection), so the code above will in fact not compile. You will need to use a derived class. The nice thing about creating it as an abstract class is that it allows us to easily implement different flavors of the transaction wrapper. This is completely in line with ADO.NET 2.0. Here's the code you need for a transaction wrapper that works on a SQL Server database.</p>   <pre class="cs" language="csharp" customtypes="SqlTransactionWrapper DbTransactionWrapper SqlConnection IsolationLevel">using System.Data;<br />using System.Data.SqlClient;<br /><br />public class SqlTransactionWrapper :<br />    DbTransactionWrapper<br />{<br />    public SqlTransactionWrapper(string connstr)<br />        : base(new SqlConnection(connstr)) { }<br /> <br />    public SqlTransactionWrapper(string connstr,<br />        IsolationLevel iso)<br />        : base(new SqlConnection(connstr), iso) { }<br />}</pre>   <p>An Oracle implementation looks like this:</p>   <pre class="cs" language="csharp" customtypes="SqlTransactionWrapper DbTransactionWrapper OracleConnection IsolationLevel">using System.Data;<br />using System.Data.OracleClient;<br /><br />public class OracleTransactionWrapper :<br />    DbTransactionWrapper<br />{<br />    public OracleTransactionWrapper(string connstr)<br />        : base(new OracleConnection(connstr)) { }<br /><br />    public OracleTransactionWrapper(string connstr,<br />        IsolationLevel iso)<br />        : base(new OracleConnection(connstr), iso)<br />    { }<br />}</pre>   <p>As you can see, the only thing you'll have to do is to create a class that derives from DbConnection (like <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx" target="_blank" title=".NET Framework Class Library - SqlConnection Class">SqlConnection</a> and <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.data.oracleclient.oracleconnection.aspx" target="_blank" title=".NET Framework Class Library - OracleConnection Class">OracleConnection</a>) and use it as an argument in the base constructor. Optionally you can build a factory class that returns a transaction wrapper based on some configuration settings. (The <a rel="external" href="http://msdn.microsoft.com/practices/" target="_blank" title="Microsoft patterns &amp; practices Developer Center">Microsoft Patterns &amp; Practices</a> group has build the <a rel="external" href="http://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en" target="_blank" title="Enterprise Library for .NET Framework 2.0 - January 2006">Enterprise Library</a> which contains such factory class in the Data Access Application Block).   </p><p> But enough talking here, let's look at the code for the DbTransactionWrapper.</p>   <pre class="cs" language="csharp" customtypes="DbTransactionWrapper IDisposable DbConnection DbTransaction ObjectDisposedException InvalidOperationException ArgumentNullException ConnectionState Exception String IsolationLevel">using System;<br />using System.Data;<br />using System.Data.Common;<br /><br />public abstract class DbTransactionWrapper : IDisposable<br />{<br />    private DbConnection connection;<br />    private DbTransaction transaction;<br />    private bool isCommitted;<br />    private bool isDisposed;<br />    private bool mustCloseConnection = true;<br />    private IsolationLevel isolationLevel;<br /><br />    // Constructor <br />    protected DbTransactionWrapper(DbConnection con)<br />        : this(con, IsolationLevel.Unspecified)<br />    {<br />    }<br /><br />    // Constructor<br />    protected DbTransactionWrapper(DbConnection con,<br />        IsolationLevel iso)<br />    {<br />        if (con == null)<br />        {<br />            throw new ArgumentNullException(&quot;con&quot;);<br />        }<br /><br />        this.isolationLevel = iso;<br /><br />        this.mustCloseConnection =<br />            (con.State != ConnectionState.Open);<br /><br />        this.connection = con;<br />    }<br /><br />    public DbTransaction Transaction<br />    {<br />        get<br />        {<br />            if (this.transaction == null)<br />            {<br />                this.transaction = <br />                    this.Connection.BeginTransaction(<br />                    this.isolationLevel);<br />            }<br /><br />            return this.transaction;<br />        }<br />    }<br /><br />    public DbConnection Connection<br />    {<br />        get<br />        {<br />            DbConnection con = this.connection;<br /><br />            if (con.State != ConnectionState.Open)<br />            {<br />                con.Open();<br />            }<br /><br />            return con;<br />        }<br />    }<br /><br />    // Implement an implicit cast operator so we<br />    // can use our class as a DbTransaction<br />    public static implicit operator DbTransaction(<br />        DbTransactionWrapper m)<br />    {<br />        return m.Transaction;<br />    }<br /><br />    public void Commit()<br />    {<br />        if (this.isDisposed == true)<br />        {<br />            throw new ObjectDisposedException(this.GetType().Name);<br />        }<br /><br />        if (this.isCommitted == true)<br />        {<br />            throw new InvalidOperationException(String.Format(<br />                &quot;{0} has already been committed.&quot;,<br />                this.GetType().Name));<br />        }<br /><br />        if (this.transaction != null)<br />        {<br />            this.transaction.Commit();<br />        }<br /><br />        this.isCommitted = true;<br />    }<br /><br />    public void Dispose()<br />    {<br />        this.Dispose(true);<br />        GC.SuppressFinalize(this);<br />    }<br /><br />    protected virtual void Dispose(bool disposing)<br />    {<br />        if (disposing == false)<br />        {<br />            return;<br />        }<br /><br />        if (this.isDisposed == true)<br />        {<br />            return;<br />        }<br /><br />        this.isDisposed = true;<br /><br />        Exception e = null;<br /><br />        if (this.transaction != null &amp;&amp;<br />            this.isCommitted == false)<br />        {<br />            // Rollback the transaction.<br />            try<br />            {<br />                this.transaction.Rollback();<br />            }<br />            catch (Exception ex)<br />            {<br />                e = ex;<br />            }<br />        }<br /><br />        // Dispose the Transaction<br />        try<br />        {<br />            if (this.transaction != null)<br />            {<br />                this.transaction.Dispose();<br />            }<br />        }<br />        catch (Exception ex)<br />        { <br />            e = ex; <br />        }<br /><br />        this.transaction = null;<br /><br />        // Dispose the Connection<br />        try<br />        {<br />            if (this.connection != null &amp;&amp;<br />                this.mustCloseConnection == true)<br />            {<br />                this.connection.Dispose();<br />            }<br />        }<br />        catch (Exception ex)<br />        { <br />            e = ex; <br />        }<br /><br />        this.connection = null;<br /><br />        if (e != null)<br />        {<br />            throw new InvalidOperationException(<br />                &quot;Exception thrown while disposing&quot;, e);<br />        }<br />    }<br />}<br /></pre><p>I think the Dispose method needs some explanation. The trick here is to catch the exceptions that can be thrown on rolling back, closing and disposing the DbTransaction and DbConnection objects (as a sort of VBScript <a rel="external" href="http://msdn2.microsoft.com/en-us/library/5hsw66as.aspx" target="_blank" title="Visual Basic Language Reference - On Error Statement (Visual Basic)">On Error Resume Next</a> statement). This way we can continue disposing objects when for instance rolling back has failed.</p><p>There is however a small problem with this code. It is possible that multiple exceptions are thrown, while we currently only rethrow the last stored exception. Instead you might try rethrowing the first exception, because this little bugger could gives us more information about what went wrong.</p><p>Note that the exception <em>e</em> is encapsulated in an InvalidOperationException. We don't simply want to rethrow <em>e</em>, because this would truncate the stack trace (see <a rel="external" href="http://mattgollob.blogspot.com/2006/08/throw-vs-throw-ex-heres-difference.html" target="_blank" title="Mattness Encapsulated - throw; vs. throw ex; Here's the difference!">Matt Gollob's blog</a> or <a rel="external" href="http://community.bartdesmet.net/blogs/bart/archive/2006/03/12/3815.aspx" target="_blank" title="Bart De Smet's on-line blog - To throw or to rethrow?">Bart de Smet's blog</a> for more information). </p><p>Note also that we return immediately when the <em>disposing </em>argument is false. This argument will be false when the Dispose method is called by a finalizer method. During finalization, there is no guaranty that our managed objects (that we want to dispose) still exist, so in that case we simply can't dispose (or rollback) anything. That we didn't implement a finalizer method in our DbTransactionWrapper doesn't matter, because we also didn't seal our class! This means someone else could still implement a finalizer in a class that inherits from our wrapper. (more information about the dispose pattern can be found <a rel="external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpgenref/html/cpconFinalizeDispose.asp" target="_blank" title=".NET Framework General Reference - Implementing Finalize and Dispose to Clean Up Unmanaged Resources">here</a>).</p><p><span style="color: #ff0000">UPDATE [2007-02-03]</span>: I changed two things in the DbTransactionWrapper's code. I changed the code in such a way that given connection won't get opened within the constructor methods. This not only makes the code more readable, but as <a rel="external" href="http://www.bluebytesoftware.com/blog/" target="_blank" title="Joe Duffy's Weblog">Joe Duffy</a> points out in <a rel="external" href="http://www.bluebytesoftware.com/blog/PermaLink.aspx?guid=c1898a31-a0aa-40af-871c-7847d98f1641" target="_blank" title="Atomicity and asynchronous exception failures">this blog</a>, '<span style="font-style: italic">prefer acquisition of resources inside discrete methods</span>' instead of acquiring them in constructors. Second, on disposal, the wrapped DbConnection will now be disposed instead of closed. The DbConnection's base class, <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.componentmodel.component.aspx" target="_blank" title="MSDN Library - System.ComponentModel.Component Class">Component</a>, implements a <a rel="external" href="http://msdn2.microsoft.com/en-us/library/system.componentmodel.component.finalize.aspx" target="_blank" title="MSDN Library - Component.Finalize Method">finalize</a> method. Not calling Dispose guaranteed the object to survive a garbage collection and it was therefore always promoted to the next generation. This leaded to to a larger memory footprint but more importantly a costly and most of all unnecessary finalization of the object, which of course is undesirable</p><p><font color="#ff0000">UPDATE [2009-10-22]: </font>It has been a couple of years since I posted this article and the knowledge I gained these years leads me to a different design of the DbTransactionWrapper class. Especially around the Dispose(bool) method. The Dispose method shouldn't do more than just dispose it's internal resources. It should not try to rollback the transaction as the given implementation does. There is actually no good reason to rollback, because a transaction will get rolled back, when it's not explicitly committed. Also, according to the Framework Design Guidelines, a dispose method should not throw an exception. This dispose method (or any dispose method for that matter) is also called in the case of a catastrophic error and in that situation it is well possible that the Rollback method will throw an exception. Throwing exceptions from Dispose method will make us loose the originally thrown exception, which is a bad thing. </p> <p>That's about it for now. I hope I inspired some of you.</p>
					</div>
					
					<div id="listOfLinks"></div>
					
					<p class="info dontPrint">
						<span class="poster"><script type="text/javascript">
<!--
	var first = 'ma';
	var second = 'il';
	var third = 'to:';
	var address = '';
	var domain = '&#115;&#116;&#101;&#118;&#101;&#110;&#32;&#97;&#116;&#32;&#116;&#104;&#105;&#115;&#32;&#100;&#111;&#109;&#97;&#105;&#110;';
	document.write('<a href="');
	document.write(first+second+third);
	document.write(address);
	document.write('&#64;');
	document.write(domain);
	document.write('" title="Email Steven">');
	document.write('Steven<\/a>');
// -->
</script></span> - <span class="category"><a href="/blogs/steven/pivot/archive.php?c=ADO.NET">ADO.NET</a>, <a href="/blogs/steven/pivot/archive.php?c=Databases">Databases</a></span> - 
						<span class="comments"><a href="/blogs/steven/pivot/entry.php?id=13#comm" title="">No comments</a> /  <a href="/blogs/steven/pivot/entry.php?id=13#track" title="">No trackbacks</a></span> - 
						<a href="/blogs/steven/archives/archive_2006-m10.php#e13" title="Permanent link to 'The DbTransactionWrapper' in the archives">&sect;</a> <a href="/blogs/steven/pivot/entry.php?id=13" title="Permanent link to entry 'The DbTransactionWrapper'">&para;</a> 
					</p>
					
					<div id="NoJavascriptWarning">
						The code samples on my weblog are colorized using javascript, but
						you disabled javascript (for my website) on your browser. 
						If you're interested in viewing the posted code snippets in 
						color, please enable javascript.
					</div>
					<script type="text/javascript">
						var noScriptWarning = document.getElementById('NoJavascriptWarning');
						noScriptWarning.style.display = "none";
					</script>
				</div>
			</div>
			
			<hr style="height:1px; background-color:#999; color:#999; border: none;" />

			<p><b>No comments:</b></p>
			<div class="comments">
			<a id="comm"></a>

			</div>

		</div>

		<hr />
		
		<div id="footer">
			<p>&copy; 2007-2019 Steven van Deursen.<br /><span class="dontPrint"><a href="/blogs/steven/rss.xml" title="XML: RSS Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/rssbutton.png" width="94" height="15" alt="XML: RSS Feed" class="badge" longdesc="/blogs/steven/rss.xml" /></a> <a href="/blogs/steven/atom.xml" title="XML: Atom Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/atombutton.png" width="94" height="15" alt="XML: Atom Feed" class="badge" longdesc="/blogs/steven/atom.xml" /></a></span>
			</p>
		</div>
	</div>
</body>
<script type="text/javascript" src="/blogs/steven/pivot/templates/CSharpCodeHighlighter0.10.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/MSILCodeHighlighter0.1.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/X86CodeHighlighter0.1.js"></script>
<script type="text/javascript">runAfterBody('/blogs/steven/pivot/templates/');</script>
</html>