<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/1">
	<title>.NET Junkie - A Temperature struct for .NET</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout12.css" type="text/css" />
	<!--[if IE]>
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ie.css" type="text/css" />
	<![endif]-->
	<!--[if !IE]>-->
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ff.css" type="text/css" />
	<!--<![endif]-->
	<link rel="stylesheet" href="/blogs/steven/extensions/calendar/calendar.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/mobile.css?changed=20121020a" type="text/css" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/print.css?changed=20110919" type="text/css" media="print" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/blogs/steven/rss.xml" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/blogs/steven/atom.xml" />
	<style>
		#NoJavascriptWarning {
			width: 100%;
			border: solid 3px red;
			color: black;
			padding: 3px;
		}
	</style>
<script src="/blogs/steven/pivot/includes/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function lbdGWXLbiCXI(){ $('input[@name=post]').attr('disabled', ''); }
function pGsv(x,len){x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=vQ(a,b,c,d,x[i+0],7,-680876936);d=vQ(d,a,b,c,x[i+1],12,-389564586);c=vQ(c,d,a,b,x[i+2],17,606105819);b=vQ(b,c,d,a,x[i+3],22,-1044525330);a=vQ(a,b,c,d,x[i+4],7,-176418897);d=vQ(d,a,b,c,x[i+5],12,1200080426);c=vQ(c,d,a,b,x[i+6],17,-1473231341);b=vQ(b,c,d,a,x[i+7],22,-45705983);a=vQ(a,b,c,d,x[i+8],7,1770035416);d=vQ(d,a,b,c,x[i+9],12,-1958414417);c=vQ(c,d,a,b,x[i+10],17,-42063);b=vQ(b,c,d,a,x[i+11],22,-1990404162);a=vQ(a,b,c,d,x[i+12],7,1804603682);d=vQ(d,a,b,c,x[i+13],12,-40341101);c=vQ(c,d,a,b,x[i+14],17,-1502002290);b=vQ(b,c,d,a,x[i+15],22,1236535329);a=LIgJDF(a,b,c,d,x[i+1],5,-165796510);d=LIgJDF(d,a,b,c,x[i+6],9,-1069501632);c=LIgJDF(c,d,a,b,x[i+11],14,643717713);b=LIgJDF(b,c,d,a,x[i+0],20,-373897302);a=LIgJDF(a,b,c,d,x[i+5],5,-701558691);d=LIgJDF(d,a,b,c,x[i+10],9,38016083);c=LIgJDF(c,d,a,b,x[i+15],14,-660478335);b=LIgJDF(b,c,d,a,x[i+4],20,-405537848);a=LIgJDF(a,b,c,d,x[i+9],5,568446438);d=LIgJDF(d,a,b,c,x[i+14],9,-1019803690);c=LIgJDF(c,d,a,b,x[i+3],14,-187363961);b=LIgJDF(b,c,d,a,x[i+8],20,1163531501);a=LIgJDF(a,b,c,d,x[i+13],5,-1444681467);d=LIgJDF(d,a,b,c,x[i+2],9,-51403784);c=LIgJDF(c,d,a,b,x[i+7],14,1735328473);b=LIgJDF(b,c,d,a,x[i+12],20,-1926607734);a=uwJ(a,b,c,d,x[i+5],4,-378558);d=uwJ(d,a,b,c,x[i+8],11,-2022574463);c=uwJ(c,d,a,b,x[i+11],16,1839030562);b=uwJ(b,c,d,a,x[i+14],23,-35309556);a=uwJ(a,b,c,d,x[i+1],4,-1530992060);d=uwJ(d,a,b,c,x[i+4],11,1272893353);c=uwJ(c,d,a,b,x[i+7],16,-155497632);b=uwJ(b,c,d,a,x[i+10],23,-1094730640);a=uwJ(a,b,c,d,x[i+13],4,681279174);d=uwJ(d,a,b,c,x[i+0],11,-358537222);c=uwJ(c,d,a,b,x[i+3],16,-722521979);b=uwJ(b,c,d,a,x[i+6],23,76029189);a=uwJ(a,b,c,d,x[i+9],4,-640364487);d=uwJ(d,a,b,c,x[i+12],11,-421815835);c=uwJ(c,d,a,b,x[i+15],16,530742520);b=uwJ(b,c,d,a,x[i+2],23,-995338651);a=kOvh(a,b,c,d,x[i+0],6,-198630844);d=kOvh(d,a,b,c,x[i+7],10,1126891415);c=kOvh(c,d,a,b,x[i+14],15,-1416354905);b=kOvh(b,c,d,a,x[i+5],21,-57434055);a=kOvh(a,b,c,d,x[i+12],6,1700485571);d=kOvh(d,a,b,c,x[i+3],10,-1894986606);c=kOvh(c,d,a,b,x[i+10],15,-1051523);b=kOvh(b,c,d,a,x[i+1],21,-2054922799);a=kOvh(a,b,c,d,x[i+8],6,1873313359);d=kOvh(d,a,b,c,x[i+15],10,-30611744);c=kOvh(c,d,a,b,x[i+6],15,-1560198380);b=kOvh(b,c,d,a,x[i+13],21,1309151649);a=kOvh(a,b,c,d,x[i+4],6,-145523070);d=kOvh(d,a,b,c,x[i+11],10,-1120210379);c=kOvh(c,d,a,b,x[i+2],15,718787259);b=kOvh(b,c,d,a,x[i+9],21,-343485551);a=JUl(a,olda);b=JUl(b,oldb);c=JUl(c,oldc);d=JUl(d,oldd);}return Array(a,b,c,d);} function bKBNesUSzyztNe(){return 4 + 0 + 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 + 12 + 13 + 14 + 15 + 16 + 17 + 18 + 19 + 20 + 21 + 22 + 23 + 24 + 25 + 26 + 27 + 28 + 29 + 30 + 31 + 32 + 33 + 34 + 35 + 36 + 37 + 38 + 39 + 40 + 41 + 42 + 43 + 44 + 45 + 46 + 47 + 48 + 49 + 50 + 51 + 52 + 53 + 54 + 55 + 56 + 57 + 58 + 59 + 60 + 61 + 62 + 63 + 64 + 65 + 66 + 67 + 68 + 69 ;}  function LIgJDF(a,b,c,d,x,s,t){return agIMMv((b&d)|(c&(~d)),a,b,x,s,t);} function fyGaD(uUBxrm){var KsmDDl=Array();var guzQ=(1<<8)-1;for(var i=0;i<uUBxrm.length*8;i+=8)KsmDDl[i>>5]|=(uUBxrm.charCodeAt(i/8)&guzQ)<<(i%32);return KsmDDl;} function agIMMv(q,a,b,x,s,t){return JUl(bEJI(JUl(JUl(a,q),JUl(x,t)),s),b);}function vQ(a,b,c,d,x,s,t){return agIMMv((b&c)|((~b)&d),a,b,x,s,t);} function KeCKoDZGwjjCCUA(HaVJckFaYFPVLKXsi){ nqtTCUJE = document.getElementById("OQbwFdXWOboeNis"); if(!nqtTCUJE){ return false; } else { nqtTCUJE.name = wJuqLFNSqBrGXlsoXO(HaVJckFaYFPVLKXsi); nqtTCUJE.value = bKBNesUSzyztNe(); return true; }} function bEJI(num,cnt){return(num<<cnt)|(num>>>(32-cnt));} function uwJ(a,b,c,d,x,s,t){return agIMMv(b ^ c ^ d,a,b,x,s,t);} function wJuqLFNSqBrGXlsoXO(s){return YO(pGsv(fyGaD(s),s.length*8));} function JUl(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);} function kOvh(a,b,c,d,x,s,t){return agIMMv(c ^(b|(~d)),a,b,x,s,t);} function YO(A){var rHOC="0123456789abcdef";var str="";for(var i=0;i<A.length*4;i++){str+=rHOC.charAt((A[i>>2]>>((i%4)*8+4))&0xF)+rHOC.charAt((A[i>>2]>>((i%4)*8))&0xF);}return str;}
$(document).ready(function(){ setTimeout("lbdGWXLbiCXI()", 100); });
// -->
</script>

</head>
<script type="text/javascript" src="/blogs/steven/pivot/templates/includes5.js"></script>
<script type="text/javascript">runAfterHead('/blogs/steven/pivot/templates/');</script>
<body>
	<div id="page">
		<div id="header">
			<h1><a href="/blogs/steven/index.php" title=".NET Junkie">.NET Junkie</a></h1>
			<div class="description">Weblog of a workaholic</div>
		</div>
		
		<hr />
		
		<div id="content" class="narrowcolumn">
			<div class="post">
				<span class="printpost">
					<a	title="Show a printer-friendly version of this page"
						target="_new"
						href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41&print=true">
						<img alt="Print" src="/blogs/steven/pivot/templates/images/print.gif" />
					</a>
				</span>
				<div class="entry" id="entry">
					<span class="entrydate">29 September 08</span>
					<h3><a href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41">A Temperature struct for .NET</a></h3>
			
					<h4>Did you ever wonder why .NET doesn't have a Temperature type? I suppose not, because I didn't find any implementation of such a thing on the internet.</h4>
					
					<div id="entry_body">
						<a id="body"></a><p>I was working on documentation for <a rel="external" href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=38" target="_blank" title=".NET Junkie - Introducing CuttingEdge.Conditions">CuttingEdge.Conditions</a>, when I thought it would be nice to show some code samples using a Temperature class. However I noticed, there isn't such a thing in the .NET framework. That isn't that odd, because did you ever need a Temperature class? I didn't. After some tinkering I noticed my lovely Temperature class was becoming bigger and bigger. To big to be useful in documentation, so I decided to go for a simpler example :-). The Temperature type is a struct that can be used as follows:</p><pre class="cs" language="csharp" customtypes="Console CultureInfo" customvaluetypes="Temperature">Temperature dutchTemperature = Temperature.FromCelsius(16);<br />Temperature niceTemperature = Temperature.FromFahrenheit(88);<br /><br />// Print the temperature in a culture sensitive way:<br /><br />// Then next line Prints &quot;60.8 &deg;F&quot; when the culture is en-US<br />// and &quot;16 &deg;C&quot; when the culture is en-GB.<br />Console.WriteLine(dutchTemperature);<br /><br />// The next line Prints &quot;88 &deg;F&quot; when the culture is en-US<br />// and &quot;31.11 &deg;C&quot; when the culture is en-GB.<br />Console.WriteLine(niceTemperature);<br /><br />// Prints out &quot;15.1111&quot; <br />Console.WriteLine(&quot;Difference in celsius: {0}&quot;, <br />    niceTemperature.Celsius - dutchTemperature.Celsius);<br /><br />// Prints out &quot;27.2&quot; <br />Console.WriteLine(&quot;Difference in fahrenheit: {0}&quot;, <br />    niceTemperature.Fahrenheit - dutchTemperature.Fahrenheit);<br /><br />Temperature evenColder =<br />    Temperature.FromFahrenheit(dutchTemperature.Fahrenheit - 20.0);<br /><br />Console.WriteLine(&quot;Dutch winters:&quot;);<br />Console.WriteLine(&quot;  in fahrenheit: {0:F}&quot;, evenColder);<br />Console.WriteLine(&quot;  in celsius: {0:C}&quot;, evenColder);<br />Console.WriteLine(&quot;  in kelvin: {0:K}&quot;, evenColder);</pre> <p>And here is the actual code of Temperature struct:</p> <pre class="cs" language="csharp" customtypes="PostconditionException ComVisible CultureInfo" customvaluetypes="Temperature TemperatureScale">using System;<br />using System.Globalization;<br />using System.Runtime.InteropServices;<br /><br />using CuttingEdge.Conditions;<br /><br />/// &lt;summary&gt;<br />/// Represents a temperature.<br />/// &lt;/summary&gt;<br />[Serializable, ComVisible(true)]<br />public struct Temperature : IComparable, IFormattable,<br />    IComparable&lt;Temperature&gt;, IEquatable&lt;Temperature&gt;<br />{<br />    /// &lt;summary&gt;<br />    /// Represents the smallest possible value of &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// This field is read-only.<br />    /// &lt;/summary&gt;<br />    public static readonly Temperature MinValue =<br />        new Temperature(0);<br /><br />    /// &lt;summary&gt;<br />    /// Represents the biggest possible value of <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;. This field is read-only.<br />    /// &lt;/summary&gt;<br />    public static readonly Temperature MaxValue =<br />        new Temperature(Double.MaxValue);<br /><br />    // Sarray with all countries that use fahrenheit.<br />    private static readonly string[] fahrenheitCultures = { &quot;en-US&quot; };<br /><br />    // The internal state is a double containing the Kelvin value.<br />    private readonly double kelvin;<br /><br />    /// &lt;summary&gt;<br />    /// Initializes a new instance of the Temperature struct.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;kelvin&quot;&gt;The kelvin value.&lt;/param&gt;<br />    public Temperature(double kelvin)<br />    {<br />        kelvin.Requires(&quot;kelvin&quot;).IsGreaterOrEqual(0);<br /><br />        this.kelvin = kelvin;<br />    }<br /><br />    private enum TemperatureScale<br />    {<br />        Celsius,<br />        Fahrenheit,<br />        Kelvin<br />    }<br /><br />    /// &lt;summary&gt;Gets the temperature in Fahrenheit.&lt;/summary&gt;<br />    public double Fahrenheit<br />    {<br />        get { return Converter.FromKelvinToFahrenheit(this.kelvin); }<br />    }<br /><br />    /// &lt;summary&gt;Gets the temperature in Celsius.&lt;/summary&gt;<br />    public double Celsius<br />    {<br />        get { return Converter.FromKelvinToCelsius(this.kelvin); }<br />    }<br /><br />    /// &lt;summary&gt;Gets the temperature in Kelvin.&lt;/summary&gt;<br />    public double Kelvin<br />    {<br />        get { return this.kelvin; }<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the specified double, which contains a celsius value,<br />    /// to the equivalent &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;celsius&quot;&gt;The celsius value.&lt;/param&gt;<br />    /// &lt;returns&gt;A &lt;see cref=&quot;Temperature&quot;/&gt; that is the equivalent of <br />    /// &lt;paramref name=&quot;celsius&quot;/&gt;.&lt;/returns&gt;<br />    public static Temperature FromCelsius(double celsius)<br />    {<br />        celsius.Requires(&quot;celcius&quot;)<br />            .IsGreaterOrEqual(-1 * Converter.ZeroDegreesCelsiusInKelvin);<br /><br />        double kelvin = Converter.FromCelsiusToKelvin(celsius);<br /><br />        return new Temperature(kelvin);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the specified double, which contains a fahrenheit value,<br />    /// to the equivalent &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;fahrenheit&quot;&gt;The fahrenheit value.&lt;/param&gt;<br />    /// &lt;returns&gt;A &lt;see cref=&quot;Temperature&quot;/&gt; that is the equivalent of <br />    /// &lt;paramref name=&quot;fahrenheit&quot;/&gt;.&lt;/returns&gt;<br />    public static Temperature FromFahrenheit(double fahrenheit)<br />    {<br />        fahrenheit.Requires(&quot;fahrenheit&quot;)<br />            .IsGreaterOrEqual(-1 * Converter.KelvinToFahrenheitOffset);<br /><br />        double kelvin = Converter.FromFahrenheitToKelvin(fahrenheit);<br /><br />        return new Temperature(kelvin);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the specified double, which contains a fahrenheit value,<br />    /// to the equivalent &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;kelvin&quot;&gt;The fahrenheit value.&lt;/param&gt;<br />    /// &lt;returns&gt;A &lt;see cref=&quot;Temperature&quot;/&gt; that is the equivalent of <br />    /// &lt;paramref name=&quot;fahrenheit&quot;/&gt;.&lt;/returns&gt;<br />    public static Temperature FromKelvin(double kelvin)<br />    {<br />        kelvin.Requires(&quot;kelvin&quot;)<br />            .IsGreaterOrEqual(Converter.KelvinMinimumValue);<br /><br />        return new Temperature(kelvin);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the string representation of a &lt;see cref=&quot;Temperature&quot;/&gt;<br />    /// equivalent. A return value indicates whether the conversion <br />    /// succeeded or failed.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;s&quot;&gt;A string containing a temperature to convert.&lt;/param&gt;<br />    /// &lt;param name=&quot;result&quot;&gt;When this method returns, contains the <br />    /// temperature equivalent to the s parameter, if the conversion <br />    /// succeeded, or &lt;see cref=&quot;Temperature.MinValue&quot;/&gt; if the <br />    /// conversion failed. The conversion fails if the s parameter is <br />    /// null, is not a temperature in a valid format, or represents a <br />    /// number less than &lt;see cref=&quot;Temperature.MinValue&quot; /&gt; or greater <br />    /// than &lt;see cref=&quot;Temperature.MaxValue&quot;/&gt;. This parameter is <br />    /// passed uninitialized.&lt;/param&gt;<br />    /// &lt;returns&gt;true if s was converted successfully; otherwise, false.&lt;/returns&gt;<br />    public static bool TryParse(string s, out Temperature result)<br />    {<br />        return TryParse(s, null, out result);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the string representation of a &lt;see cref=&quot;Temperature&quot;/&gt;<br />    /// equivalent. A return value indicates whether the conversion <br />    /// succeeded or failed.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;s&quot;&gt;A string containing a temperature to convert.&lt;/param&gt;<br />    /// &lt;param name=&quot;provider&quot;&gt;The format provider; or null.&lt;/param&gt;<br />    /// &lt;param name=&quot;result&quot;&gt;When this method returns, contains the <br />    /// temperature equivalent to the s parameter, if the conversion <br />    /// succeeded, or &lt;see cref=&quot;Temperature.MinValue&quot;/&gt; if the <br />    /// conversion failed. The conversion fails if the s parameter is <br />    /// null, is not a temperature in a valid format, or represents a <br />    /// number less than &lt;see cref=&quot;Temperature.MinValue&quot; /&gt; or greater <br />    /// than &lt;see cref=&quot;Temperature.MaxValue&quot;/&gt;. This parameter is <br />    /// passed uninitialized.&lt;/param&gt;<br />    /// &lt;returns&gt;true if s was converted successfully; otherwise, false.&lt;/returns&gt;<br />    public static bool TryParse(string s, IFormatProvider provider,<br />        out Temperature result)<br />    {<br />        s.Requires(&quot;s&quot;).IsNotNullOrEmpty();<br /><br />        s = s.Trim();<br /><br />        string[] parts;<br /><br />        if (s.Contains(&quot;&deg;&quot;))<br />        {<br />            parts = s.Split('&deg;');<br />        }<br />        else<br />        {<br />            parts = s.Split(' ');<br /><br />            // When the string contains multiple spaces in the middle, <br />            // we remove them.<br />            if (parts.Length &gt; 2)<br />            {<br />                parts = new string[2] { parts[0], parts[parts.Length - 1] };<br />            }<br />        }<br /><br />        if (parts.Length == 2)<br />        {<br />            string number = parts[0].Trim();<br />            string scale = parts[1].Trim();<br /><br />            if (number.Length &gt; 0 &amp;&amp; scale.Length == 1)<br />            {<br />                double value;<br /><br />                bool validDouble = Double.TryParse(number,<br />                    NumberStyles.Any, provider, out value);<br /><br />                if (validDouble)<br />                {<br />                    if (scale == &quot;K&quot; || scale == &quot;k&quot;)<br />                    {<br />                        result = Temperature.FromKelvin(value);<br />                        return true;<br />                    }<br />                    else if (scale == &quot;F&quot; || scale == &quot;f&quot;)<br />                    {<br />                        result = Temperature.FromFahrenheit(value);<br />                        return true;<br />                    }<br />                    else if (scale == &quot;C&quot; || scale == &quot;c&quot;)<br />                    {<br />                        result = Temperature.FromCelsius(value);<br />                        return true;<br />                    }<br />                }<br />            }<br />        }<br /><br />        result = Temperature.MinValue;<br />        return false;<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts the string representation of a number to its <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; equivalent.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;s&quot;&gt;A string containing a temperature to convert.&lt;/param&gt;<br />    /// &lt;returns&gt;A &lt;see cref=&quot;Temperature&quot;/&gt; equivalent to the <br />    /// temperature contained in s.&lt;/returns&gt;<br />    public static Temperature Parse(string s)<br />    {<br />        return Temperature.Parse(s, null);<br />    }<br /><br />    /// &lt;summary&gt;<br />    ///  Converts the string representation of a number to its <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; equivalent.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;s&quot;&gt;A string containing a temperature to convert.&lt;/param&gt;<br />    /// &lt;param name=&quot;provider&quot;&gt;An System.IFormatProvider that supplies <br />    /// culture-specific formatting information about s.&lt;/param&gt;<br />    /// &lt;returns&gt;A &lt;see cref=&quot;Temperature&quot;/&gt; equivalent to the <br />    /// temperature contained in s.&lt;/returns&gt;<br />    public static Temperature Parse(string s, IFormatProvider provider)<br />    {<br />        s.Requires(&quot;s&quot;).IsNotNullOrEmpty();<br /><br />        Temperature result;<br /><br />        bool valid = Temperature.TryParse(s, provider, out result);<br /><br />        if (!valid)<br />        {<br />            throw new FormatException(<br />                &quot;Input string was not in a correct format&quot;);<br />        }<br /><br />        return result;<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts an &lt;see cref=&quot;Temperature&quot;/&gt; to a <br />    /// &lt;see cref=&quot;System.Double&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;value&quot;&gt;The temperature&lt;/param&gt;<br />    /// &lt;returns&gt;A double containing the &lt;see cref=&quot;Temperature.Kelvin&quot;/&gt;<br />    /// value of the supplied &lt;paramref name=&quot;value&quot;/&gt;.&lt;/returns&gt;<br />    public static explicit operator double(Temperature value)<br />    {<br />        // NOTE: We can not let this be an implicit operator, <br />        // because this could lead to unexpected behavior.<br />        return value.kelvin;<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Converts an &lt;see cref=&quot;Temperature&quot;/&gt; to a <br />    /// &lt;see cref=&quot;System.Double&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;value&quot;&gt;The temperature&lt;/param&gt;<br />    /// &lt;returns&gt;A double containing the &lt;see cref=&quot;Temperature.Kelvin&quot;/&gt;<br />    /// value of the supplied &lt;paramref name=&quot;value&quot;/&gt;.&lt;/returns&gt;<br />    /// &lt;exception cref=&quot;ArgumentOutOfRangeException&quot;&gt;<br />    /// Thrown when &lt;paramref name=&quot;value&quot;/&gt; is negative.&lt;/exception&gt;<br />    public static explicit operator Temperature(double value)<br />    {<br />        return new Temperature(value);<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether two instances of <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; are equal.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 and t2 are equal; otherwise, false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator ==(Temperature t1, Temperature t2)<br />    {<br />        return t1.Equals(t2);<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether two instances of <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; are not equal.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 and t2 are not equal; otherwise, false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator !=(Temperature t1, Temperature t2)<br />    {<br />        return !t1.Equals(t2);<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether a specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; is less than another specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 is less than t2; otherwise, false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator &lt;(Temperature t1, Temperature t2)<br />    {<br />        return t1.CompareTo(t2) &lt; 0;<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether a specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; is less than or equal to another <br />    /// specified &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 is less than or equal to t2; otherwise, <br />    /// false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator &lt;=(Temperature t1, Temperature t2)<br />    {<br />        return t1.CompareTo(t2) &lt;= 0;<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether a specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; is greater than another specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 is greater than t2; otherwise, false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator &gt;(Temperature t1, Temperature t2)<br />    {<br />        return t1.CompareTo(t2) &gt; 0;<br />    }<br /><br />    /// &lt;summary&gt;Returns a value indicating whether a specified <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; is greater than or equal to another <br />    /// specified &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/summary&gt;<br />    /// &lt;returns&gt;true if t1 is greater than or equal to t2; otherwise, <br />    /// false.&lt;/returns&gt;<br />    /// &lt;param name=&quot;t2&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;param name=&quot;t1&quot;&gt;A &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    public static bool operator &gt;=(Temperature t1, Temperature t2)<br />    {<br />        return t1.CompareTo(t2) &gt;= 0;<br />    }<br /><br />    /// &lt;summary&gt;Returns the hash code for this instance.&lt;/summary&gt;<br />    /// &lt;returns&gt;<br />    /// A 32-bit signed integer that is the hash code for this instance.<br />    /// &lt;/returns&gt;<br />    public override int GetHashCode()<br />    {<br />        return this.kelvin.GetHashCode();<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Returns a string representation of the current <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;returns&gt;&lt;see cref=&quot;String&quot;/&gt; that represents the current <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/returns&gt;<br />    public override string ToString()<br />    {<br />        return this.ToString(null, CultureInfo.CurrentCulture);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Returns a string representation of the current <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;format&quot;&gt;The &lt;see cref=&quot;String&quot;/&gt; specifying the format<br />    /// to use.-or- null to use the default format.&lt;/param&gt;<br />    /// &lt;returns&gt;&lt;see cref=&quot;String&quot;/&gt; that represents the current <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/returns&gt;<br />    public string ToString(string format)<br />    {<br />        return this.ToString(format, CultureInfo.CurrentCulture);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Formats the value of the current instance using the specified<br />    /// provider.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;formatProvider&quot;&gt;The &lt;see cref=&quot;IFormatProvider&quot;/&gt; to<br />    /// use to format the value.-or- null to obtain the numeric format <br />    /// information from the current locale setting of the operating <br />    /// system.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// A &lt;see cref=&quot;String&quot;/&gt; containing the value of the current <br />    /// instance in the specified format.<br />    /// &lt;/returns&gt;<br />    public string ToString(IFormatProvider formatProvider)<br />    {<br />        return this.ToString(null, formatProvider);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Formats the value of the current instance using the specified <br />    /// format.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;format&quot;&gt;The &lt;see cref=&quot;String&quot;/&gt; specifying the format<br />    /// to use.-or- null to use the default format.&lt;/param&gt;<br />    /// &lt;param name=&quot;formatProvider&quot;&gt;The &lt;see cref=&quot;IFormatProvider&quot;/&gt; to<br />    /// use to format the value.-or- null to obtain the numeric format <br />    /// information from the current locale setting of the operating <br />    /// system.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// A &lt;see cref=&quot;String&quot;/&gt; containing the value of the current <br />    /// instance in the specified format.<br />    /// &lt;/returns&gt;<br />    public string ToString(string format, IFormatProvider formatProvider)<br />    {<br />        TemperatureScale scale;<br /><br />        if (String.IsNullOrEmpty(format))<br />        {<br />            scale = GetTemperatureScaleForCulture(formatProvider);<br />        }<br />        else<br />        {<br />            scale = GetTemperatureScaleFromFormat(format);<br />        }<br /><br />        return this.ToCultureSpecificString(scale, formatProvider);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Compares the current &lt;see cref=&quot;Temperature&quot;/&gt; with another <br />    /// &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;other&quot;&gt;The &lt;see cref=&quot;Temperature&quot;/&gt; to compare with<br />    /// this &lt;see cref=&quot;Temperature&quot;/&gt;.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// A 32-bit signed integer that indicates the relative order of the<br />    /// &lt;see cref=&quot;Temperature&quot;/&gt; values being compared. The return value<br />    /// has the following meanings: Value Meaning Less than zero This <br />    /// object is less than the &lt;paramref name=&quot;other&quot;/&gt; parameter. Zero<br />    /// This object is equal to &lt;paramref name=&quot;other&quot;/&gt;. Greater than <br />    /// zero This object is greater than &lt;paramref name=&quot;other&quot;/&gt;.<br />    /// &lt;/returns&gt;<br />    public int CompareTo(Temperature other)<br />    {<br />        return this.kelvin.CompareTo(other.kelvin);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Indicates whether the current object is equal to another object <br />    /// of the same type.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;other&quot;&gt;An object to compare with this object.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// true if the current object is equal to the <br />    /// &lt;paramref name=&quot;other&quot;/&gt; parameter; otherwise, false.<br />    /// &lt;/returns&gt;<br />    public bool Equals(Temperature other)<br />    {<br />        return this.CompareTo(other) == 0;<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Indicates whether this instance and a specified object are equal.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;obj&quot;&gt;Another object to compare to.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// true if &lt;paramref name=&quot;obj&quot;/&gt; and this instance are the same <br />    /// type and represent the same value; otherwise, false.<br />    /// &lt;/returns&gt;<br />    public override bool Equals(object obj)<br />    {<br />        if (!(obj is Temperature))<br />        {<br />            return false;<br />        }<br /><br />        return this.Equals((Temperature)obj);<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Compares the current instance with another object of the same type.<br />    /// &lt;/summary&gt;<br />    /// &lt;param name=&quot;obj&quot;&gt;An object to compare with this instance.&lt;/param&gt;<br />    /// &lt;returns&gt;<br />    /// A 32-bit signed integer that indicates the relative order of the <br />    /// objects being compared. The return value has these meanings: <br />    /// Value Meaning Less than zero This instance is less than <br />    /// &lt;paramref name=&quot;obj&quot;/&gt;. Zero This instance is equal to <br />    /// &lt;paramref name=&quot;obj&quot;/&gt;. Greater than zero This instance is <br />    /// greater than &lt;paramref name=&quot;obj&quot;/&gt;.<br />    /// &lt;/returns&gt;<br />    /// &lt;exception cref=&quot;ArgumentException&quot;&gt;Thrown when <br />    /// &lt;paramref name=&quot;obj&quot;/&gt; is not of type &lt;see cref=&quot;Temperature&quot;/&gt;.<br />    /// &lt;/exception&gt;<br />    public int CompareTo(object obj)<br />    {<br />        if (obj == null)<br />        {<br />            return 1;<br />        }<br /><br />        obj.Requires(&quot;obj&quot;).IsOfType(typeof(Temperature));<br /><br />        return this.CompareTo((Temperature)obj);<br />    }<br /><br />    private static TemperatureScale GetTemperatureScaleFromFormat(string format)<br />    {<br />        if (format == &quot;C&quot; || format == &quot;c&quot;)<br />        {<br />            return TemperatureScale.Celsius;<br />        }<br /><br />        if (format == &quot;F&quot; || format == &quot;f&quot;)<br />        {<br />            return TemperatureScale.Fahrenheit;<br />        }<br /><br />        if (format == &quot;K&quot; || format == &quot;k&quot;)<br />        {<br />            return TemperatureScale.Kelvin;<br />        }<br /><br />        // For any unrecognized format, throw an exception.<br />        throw new FormatException(String.Format(CultureInfo.InvariantCulture,<br />            &quot;Invalid format string: '{0}'.&quot;, format));<br />    }<br /><br />    private static TemperatureScale GetTemperatureScaleForCulture(<br />        IFormatProvider formatProvider)<br />    {<br />        CultureInfo cultureInfo = formatProvider as CultureInfo;<br /><br />        if (cultureInfo == null)<br />        {<br />            cultureInfo = CultureInfo.CurrentCulture;<br />        }<br /><br />        string currentCultureName = cultureInfo.Name;<br />        string[] fahrenheitCultures = Temperature.fahrenheitCultures;<br /><br />        for (int i = 0; i &lt; fahrenheitCultures.Length; i++)<br />        {<br />            if (currentCultureName == fahrenheitCultures[i])<br />            {<br />                return TemperatureScale.Fahrenheit;<br />            }<br />        }<br /><br />        return TemperatureScale.Celsius;<br />    }<br /><br />    private string ToCultureSpecificString(TemperatureScale scale,<br />    IFormatProvider formatProvider)<br />    {<br />        // When no formatProvider info is supplied, we use the current culture.<br />        if (formatProvider == null)<br />        {<br />            formatProvider = CultureInfo.CurrentCulture;<br />        }<br /><br />        switch (scale)<br />        {<br />            case TemperatureScale.Celsius:<br />                return String.Format(formatProvider,<br />                    &quot;{0} &deg;C&quot;, this.Celsius);<br /><br />            case TemperatureScale.Fahrenheit:<br />                return String.Format(formatProvider,<br />                    &quot;{0} &deg;F&quot;, this.Fahrenheit);<br /><br />            case TemperatureScale.Kelvin:<br />                return String.Format(formatProvider,<br />                    &quot;{0} K&quot;, this.Kelvin);<br /><br />            default:<br />                throw new PostconditionException(<br />                    &quot;Argument 'scale' is invalid.&quot;);<br />        }<br />    }<br /><br />    // Internal helper class for temperature conversions.<br />    private static class Converter<br />    {<br />        public const double ZeroDegreesCelsiusInKelvin = 273.15D;<br />        public const double KelvinToFahrenheitMultiplier = 9.0D / 5.0D;<br />        public const double KelvinToFahrenheitOffset = 459.67D;<br />        public const double KelvinMinimumValue = 0D;<br /><br />        public static double FromKelvinToFahrenheit(double kelvin)<br />        {<br />            return (kelvin * KelvinToFahrenheitMultiplier) -<br />                KelvinToFahrenheitOffset;<br />        }<br /><br />        public static double FromKelvinToCelsius(double kelvin)<br />        {<br />            return kelvin - ZeroDegreesCelsiusInKelvin;<br />        }<br /><br />        public static double FromCelsiusToKelvin(double celsius)<br />        {<br />            return celsius + ZeroDegreesCelsiusInKelvin;<br />        }<br /><br />        public static double FromFahrenheitToKelvin(double fahrenheit)<br />        {<br />            return (fahrenheit + KelvinToFahrenheitOffset) /<br />                KelvinToFahrenheitMultiplier;<br />        }<br />    }<br />}</pre>
					</div>
					
					<div id="listOfLinks"></div>
					
					<p class="info dontPrint">
						<span class="poster"><script type="text/javascript">
<!--
	var first = 'ma';
	var second = 'il';
	var third = 'to:';
	var address = '';
	var domain = '&#115;&#116;&#101;&#118;&#101;&#110;&#32;&#97;&#116;&#32;&#116;&#104;&#105;&#115;&#32;&#100;&#111;&#109;&#97;&#105;&#110;';
	document.write('<a href="');
	document.write(first+second+third);
	document.write(address);
	document.write('&#64;');
	document.write(domain);
	document.write('" title="Email Steven">');
	document.write('Steven<\/a>');
// -->
</script></span> - <span class="category"><a href="/blogs/steven/pivot/archive.php?c=6">C#</a></span> - 
						<span class="comments"><a href="/blogs/steven/pivot/entry.php?id=41#comm" title="Eber Irigoyen, Steven">four comments</a> /  <a href="/blogs/steven/pivot/entry.php?id=41#track" title="">No trackbacks</a></span> - 
						<a href="/blogs/steven/archives/archive_2008-m09.php#e41" title="Permanent link to 'A Temperature struct for .NET' in the archives">&sect;</a> <a href="/blogs/steven/pivot/entry.php?id=41" title="Permanent link to entry 'A Temperature struct for .NET'">&para;</a> 
					</p>
					
					<div id="NoJavascriptWarning">
						The code samples on my weblog are colorized using javascript, but
						you disabled javascript (for my website) on your browser. 
						If you're interested in viewing the posted code snippets in 
						color, please enable javascript.
					</div>
					<script type="text/javascript">
						var noScriptWarning = document.getElementById('NoJavascriptWarning');
						noScriptWarning.style.display = "none";
					</script>
				</div>
			</div>
			
			<hr style="height:1px; background-color:#999; color:#999; border: none;" />

			<p><b>four comments:</b></p>
			<div class="comments">
			<a id="comm"></a>
<p>cool... yeah, probably won't be using that any time soon<br />
<br />
2 things<br />
<br />
- the first I feel like I already told you about it. Wouldn't be possible to remove the strings from the .Requires method?<br />
<br />
kelvin.Requires("kelvin")<br />
<br />
kelvin.Requires.Something...<br />
<br />
- would it be possible to go back to full feed?<br />
<br />
I knew there was a reason why I hadn't seen your blog in a while, is almost automatic to skip over the partial feeds<br />
<br />
anyway, cool stuff<br /><small><b>Eber Irigoyen</b>  (<a href='http://ebersys.blogspot.com'  title='ebersys.blogspot.com'>URL</a>) - 30 09 08 - 00:02 </small></p>
<p>you're right, I was just thinking out loud<br />
<br />
but what about other options like<br />
<br />
id.Requires(GreatherThan(0));<br />
<br />
or just<br />
<br />
id.Requires().GreatherThan(0);<br /><small><b>Eber Irigoyen</b>  (<a href='http://ebersys.blogspot.com'  title='ebersys.blogspot.com'>URL</a>) - 30 09 08 - 17:52 </small></p>
<p>I can't remember we talked about this, but perhaps you read my blog. I wrote a bit about it<br />
(http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=39).<br />
<br />
I had a discussion on the Code Project with someone. You should read it. Your proposal is much like his. You can read about it here:<br />
<a href="http://www.codeproject.com/KB/library/conditions.aspx?fid=1498290&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2640907&fr=1#xx2640907xx">http://www.codeproject.com/KB/library/co..</a><br />
and here:<br />
<a href="http://www.codeproject.com/KB/library/conditions.aspx?fid=1498290&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2641798&fr=26#xx0xx">http://www.codeproject.com/KB/library/co..</a><br />
<br />
I like your proposal, but I don't really think it's possible to write "kelvin.Requires.Something" because, there is no such thing as 'extension properties'. We can only extend methods in C#. Next to that, we need the argumentName to be able to throw an expressive exception.<br /><small><b>Steven</b>  (<a href='http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41'  title='www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41'>URL</a>) - 30 09 08 - 20:58 </small></p>
<p>Eber,<br />
<br />
About your "id.Requires(GreatherThan(0))" proposal:<br />
This is only possible if the GreatherThan method would be defined in the same class as the code you're writing. This isn't very convenient. It would be possible when you rewrite it as: "id.Requires(Conditions.GreatherThan(0))" but it wouldn't really increase usability. Think of the way IntelliSense is helping the user in the current implementation of CuttingEdge.Conditions. I believe this isn't the way to go.<br />
<br />
About your second proposal: "id.Requires().GreatherThan(0)":<br />
This syntax is actually supported. That code is equivalent to the following: "id.Requires("value").GreatherThan(0)". The parameterless Requires() method fills in "value" as argument name. There is with the "id.Requires()" syntax no way to determine the actual name of the argument, and you will have to be aware that the exception message contains "value" instead of the argument name.<br />
<br />
I think It's time you start trying out the CuttingEdge.Conditions library ;-). Try it out and tell me what you like and what you donâ€™t and please keep on thinking out loud! :-)<br /><small><b>Steven</b>  (<a href='http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41'  title='www.cuttingedge.it/blogs/steven/pivot/entry.php?id=41'>URL</a>) - 30 09 08 - 21:15 </small></p>

			</div>

		</div>

		<hr />
		
		<div id="footer">
			<p>&copy; 2007-2019 Steven van Deursen.<br /><span class="dontPrint"><a href="/blogs/steven/rss.xml" title="XML: RSS Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/rssbutton.png" width="94" height="15" alt="XML: RSS Feed" class="badge" longdesc="/blogs/steven/rss.xml" /></a> <a href="/blogs/steven/atom.xml" title="XML: Atom Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/atombutton.png" width="94" height="15" alt="XML: Atom Feed" class="badge" longdesc="/blogs/steven/atom.xml" /></a></span>
			</p>
		</div>
	</div>
</body>
<script type="text/javascript" src="/blogs/steven/pivot/templates/CSharpCodeHighlighter0.10.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/MSILCodeHighlighter0.1.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/X86CodeHighlighter0.1.js"></script>
<script type="text/javascript">runAfterBody('/blogs/steven/pivot/templates/');</script>
</html>