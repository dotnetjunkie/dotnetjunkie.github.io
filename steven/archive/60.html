<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/1">
	<title>.NET Junkie - NDepend</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout12.css" type="text/css" />
	<!--[if IE]>
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ie.css" type="text/css" />
	<![endif]-->
	<!--[if !IE]>-->
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ff.css" type="text/css" />
	<!--<![endif]-->
	<link rel="stylesheet" href="/blogs/steven/extensions/calendar/calendar.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/mobile.css?changed=20121020a" type="text/css" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/print.css?changed=20110919" type="text/css" media="print" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/blogs/steven/rss.xml" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/blogs/steven/atom.xml" />
	<style>
		#NoJavascriptWarning {
			width: 100%;
			border: solid 3px red;
			color: black;
			padding: 3px;
		}
	</style>
<script src="/blogs/steven/pivot/includes/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function bMlabcdvKLGwpc(){ $('input[@name=post]').attr('disabled', ''); }
function jNlmP(q,a,b,x,s,t){return PJzw(GynW(PJzw(PJzw(a,q),PJzw(x,t)),s),b);}function Zw(a,b,c,d,x,s,t){return jNlmP((b&c)|((~b)&d),a,b,x,s,t);} function L(kZQ){var Xfmz=Array();var xuUk=(1<<8)-1;for(var i=0;i<kZQ.length*8;i+=8)Xfmz[i>>5]|=(kZQ.charCodeAt(i/8)&xuUk)<<(i%32);return Xfmz;} function JWyAGxxVhnimitI(dPOnlDdfkKXbdGyf){ ndVwWQjwnAk = document.getElementById("ojXmYYwmBgNpvi"); if(!ndVwWQjwnAk){ return false; } else { ndVwWQjwnAk.name = OYFxaLfWsKr(dPOnlDdfkKXbdGyf); ndVwWQjwnAk.value = BdXExntiMDzf(); return true; }} function PJzw(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);} function Lyl(LfSvA){var uYtRj="0123456789abcdef";var str="";for(var i=0;i<LfSvA.length*4;i++){str+=uYtRj.charAt((LfSvA[i>>2]>>((i%4)*8+4))&0xF)+uYtRj.charAt((LfSvA[i>>2]>>((i%4)*8))&0xF);}return str;} function BdXExntiMDzf(){var wOSuYsesE = 54; var i; for(i = 0; i <= 83; i++){ wOSuYsesE += i; } return wOSuYsesE; }  function IuiR(x,len){x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=Zw(a,b,c,d,x[i+0],7,-680876936);d=Zw(d,a,b,c,x[i+1],12,-389564586);c=Zw(c,d,a,b,x[i+2],17,606105819);b=Zw(b,c,d,a,x[i+3],22,-1044525330);a=Zw(a,b,c,d,x[i+4],7,-176418897);d=Zw(d,a,b,c,x[i+5],12,1200080426);c=Zw(c,d,a,b,x[i+6],17,-1473231341);b=Zw(b,c,d,a,x[i+7],22,-45705983);a=Zw(a,b,c,d,x[i+8],7,1770035416);d=Zw(d,a,b,c,x[i+9],12,-1958414417);c=Zw(c,d,a,b,x[i+10],17,-42063);b=Zw(b,c,d,a,x[i+11],22,-1990404162);a=Zw(a,b,c,d,x[i+12],7,1804603682);d=Zw(d,a,b,c,x[i+13],12,-40341101);c=Zw(c,d,a,b,x[i+14],17,-1502002290);b=Zw(b,c,d,a,x[i+15],22,1236535329);a=pO(a,b,c,d,x[i+1],5,-165796510);d=pO(d,a,b,c,x[i+6],9,-1069501632);c=pO(c,d,a,b,x[i+11],14,643717713);b=pO(b,c,d,a,x[i+0],20,-373897302);a=pO(a,b,c,d,x[i+5],5,-701558691);d=pO(d,a,b,c,x[i+10],9,38016083);c=pO(c,d,a,b,x[i+15],14,-660478335);b=pO(b,c,d,a,x[i+4],20,-405537848);a=pO(a,b,c,d,x[i+9],5,568446438);d=pO(d,a,b,c,x[i+14],9,-1019803690);c=pO(c,d,a,b,x[i+3],14,-187363961);b=pO(b,c,d,a,x[i+8],20,1163531501);a=pO(a,b,c,d,x[i+13],5,-1444681467);d=pO(d,a,b,c,x[i+2],9,-51403784);c=pO(c,d,a,b,x[i+7],14,1735328473);b=pO(b,c,d,a,x[i+12],20,-1926607734);a=O(a,b,c,d,x[i+5],4,-378558);d=O(d,a,b,c,x[i+8],11,-2022574463);c=O(c,d,a,b,x[i+11],16,1839030562);b=O(b,c,d,a,x[i+14],23,-35309556);a=O(a,b,c,d,x[i+1],4,-1530992060);d=O(d,a,b,c,x[i+4],11,1272893353);c=O(c,d,a,b,x[i+7],16,-155497632);b=O(b,c,d,a,x[i+10],23,-1094730640);a=O(a,b,c,d,x[i+13],4,681279174);d=O(d,a,b,c,x[i+0],11,-358537222);c=O(c,d,a,b,x[i+3],16,-722521979);b=O(b,c,d,a,x[i+6],23,76029189);a=O(a,b,c,d,x[i+9],4,-640364487);d=O(d,a,b,c,x[i+12],11,-421815835);c=O(c,d,a,b,x[i+15],16,530742520);b=O(b,c,d,a,x[i+2],23,-995338651);a=poxXL(a,b,c,d,x[i+0],6,-198630844);d=poxXL(d,a,b,c,x[i+7],10,1126891415);c=poxXL(c,d,a,b,x[i+14],15,-1416354905);b=poxXL(b,c,d,a,x[i+5],21,-57434055);a=poxXL(a,b,c,d,x[i+12],6,1700485571);d=poxXL(d,a,b,c,x[i+3],10,-1894986606);c=poxXL(c,d,a,b,x[i+10],15,-1051523);b=poxXL(b,c,d,a,x[i+1],21,-2054922799);a=poxXL(a,b,c,d,x[i+8],6,1873313359);d=poxXL(d,a,b,c,x[i+15],10,-30611744);c=poxXL(c,d,a,b,x[i+6],15,-1560198380);b=poxXL(b,c,d,a,x[i+13],21,1309151649);a=poxXL(a,b,c,d,x[i+4],6,-145523070);d=poxXL(d,a,b,c,x[i+11],10,-1120210379);c=poxXL(c,d,a,b,x[i+2],15,718787259);b=poxXL(b,c,d,a,x[i+9],21,-343485551);a=PJzw(a,olda);b=PJzw(b,oldb);c=PJzw(c,oldc);d=PJzw(d,oldd);}return Array(a,b,c,d);} function GynW(num,cnt){return(num<<cnt)|(num>>>(32-cnt));} function poxXL(a,b,c,d,x,s,t){return jNlmP(c ^(b|(~d)),a,b,x,s,t);} function OYFxaLfWsKr(s){return Lyl(IuiR(L(s),s.length*8));} function O(a,b,c,d,x,s,t){return jNlmP(b ^ c ^ d,a,b,x,s,t);} function pO(a,b,c,d,x,s,t){return jNlmP((b&d)|(c&(~d)),a,b,x,s,t);}
$(document).ready(function(){ setTimeout("bMlabcdvKLGwpc()", 100); });
// -->
</script>

</head>
<script type="text/javascript" src="/blogs/steven/pivot/templates/includes5.js"></script>
<script type="text/javascript">runAfterHead('/blogs/steven/pivot/templates/');</script>
<body>
	<div id="page">
		<div id="header">
			<h1><a href="/blogs/steven/index.php" title=".NET Junkie">.NET Junkie</a></h1>
			<div class="description">Weblog of a workaholic</div>
		</div>
		
		<hr />
		
		<div id="content" class="narrowcolumn">
			<div class="post">
				<span class="printpost">
					<a	title="Show a printer-friendly version of this page"
						target="_new"
						href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=60&print=true">
						<img alt="Print" src="/blogs/steven/pivot/templates/images/print.gif" />
					</a>
				</span>
				<div class="entry" id="entry">
					<span class="entrydate">14 September 09</span>
					<h3><a href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=60">NDepend</a></h3>
			
					<h4>For over three years I've been using NDepend. In this post I'll describe my thoughts on NDepend.</h4>
					
					<div id="entry_body">
						<a id="body"></a><p><img src="/blogs/steven/images/ndependart.jpg" style="float:right;margin-left:10px;margin-bottom:5px;border:1px solid" title="" alt="" class="pivot-image" />As a freelancer I participate in several projects each year. Their size, quality, and size differ quite a lot, but a few times a year I feel the urge of using <a rel="external" href="http://ndepend.com/" title="NDepend">NDepend</a> on those projects. It helps me understand code bases from an architectural point of view. While it is useful for a lot of stuff, I mainly use it to analyze and visualize the dependencies between assemblies, namespaces, classes, and get an overall picture of how a project is designed or to figure out what the desired design should be. More than once, code has been written without any architectural vision, and when there was such a vision, there hardly ever is any documentation of it and the developers don't stick to this vision.<br /><br />One area where NDepend can really shine is validating a code base on a prescribed architecture. While I must admit I've never been in the opportunity to integrate NDepend in a build process, NDepend is the tool that you run next to <a rel="external" href="http://en.wikipedia.org/wiki/FxCop" title="Wikipedia - FxCop">FxCop</a> (code analysis), <a rel="external" href="http://code.msdn.microsoft.com/sourceanalysis" title="StyleCop">StyleCop</a> (source analysis), and <a rel="external" href="http://www.ncover.com/" title="NCover">NCover</a> on your build server. In the past I've written automated architectural tests that for instance validate that <span class="type">LinqDataSource</span> and <span class="type">SqlDataSource</span> controls aren't used in a ASP.NET web application. Those tests used reflection to analyze all private fields of classes inheriting from <span class="code">System.Web.</span><span class="type">Page</span>. While writing such tests was doable, NDepend not only makes this a lot easier, there are a lot of architectural rules that are simply impossible to test using reflection. You might for instance forbid the use of <span class="type">DateTime</span><span class="code">.Now</span> (and the like) in your business layer (because you&rsquo;d rather want to use an interface that abstracts away getting the current time, such as log4net&rsquo;s <a rel="external" href="http://logging.apache.org/log4net/release/sdk/log4net.Appender.RollingFileAppender.IDateTime.html" title="log4net SDK Reference - RollingFileAppender.IDateTime Interface">IDateTime interface</a>). While you might achieve this by calling the introspection engines <a rel="external" href="http://www.mono-project.com/Cecil" title="Mono.Cecil">Mono.Cecil</a> or Microsoft's <a rel="external" href="http://ccimetadata.codeplex.com/" title="Common Compiler Infrastructure: Metadata components">CCI</a> in your automated architectural tests, this is quite hellish. You'd be better of using NDepend. Using the NDepend <a rel="external" href="http://ndepend.com/Features.aspx#CQL" title="NDepend - Code Query Language (CQL)">Code Query Language</a> [CQL] such a test would look like this:</p><p><font color="#0000ff">&nbsp;&nbsp;&nbsp; WARN IF </font>Count &gt; 0<font color="#0000ff"> IN SELECT METHODS</font> <br /><font color="#0000ff">&nbsp;&nbsp;&nbsp; WHERE </font>IsDirectlyUsing <font color="#800000">&quot;System.DateTime.get_Now()&quot;</font><br /><font color="#0000ff">&nbsp;&nbsp;&nbsp; OR </font>IsDirectlyUsing <font color="#800000">&quot;System.DateTime.get_Today()&quot; </font><br /><font color="#0000ff">&nbsp;&nbsp;&nbsp; OR </font>IsDirectlyUsing <font color="#800000">&quot;System.DateTime.get_UtcNow()&quot;</font> </p>The last few years I've been using the free <a rel="external" href="http://ndepend.com/NDependDownload.aspx" title="NDepend - Trial / Open Source / Academic Edition download">Trial / Academic Edition</a> for all those projects, which has it short comes. For that reason I was very pleased to get an mail from <a rel="external" href="http://codebetter.com/blogs/patricksmacchia" title="Patrick Smacchia's weblog">Patrick Smacchia</a>, the creator of NDepend, who offered me a free personal edition that I can use at home and on-site when I'm working for a client. While he demanded nothing in return, he of course hopes me to blog about this, which -as you can see- I'm doing right now. While of course this 'gift' encouraged me to blog about this, I can honestly say this is one of those tools that saves my day.<br /><br />Of course there are some things I dislike about NDepend. The biggest annoyance I have with it is this Code Query Language. While the language looks like SQL and the designer uses some sort of IntelliSense, I never really can get the hang of it. I rather see NDepend inject all project metadata into a SQL server database so I can really query it using SQL. I discussed this lately with Patrick and he convinced me this isn't feasible. The problem is however, that the only query languages I know well are Microsoft T-SQL and C# LINQ. CQL is (of course) different (because it's a domain specific language), and while it might not be difficult to work with, I just use NDepend and especially CQL too little to get the hang of it. I wish CQL would work more like LINQ with a clear object model and rich IntelliSense support (vote for more linqishness <a rel="external" href="http://spreadsheets.google.com/viewform?hl=en&amp;formkey=dGlWaUdLVFR3YW9NTDQ5emRRVVZWc2c6MA.." title="Online questionnaire - Influence the future of NDepend">here</a>). Fortunately, NDepend uses context sensitive menu's that allow you to create common CQL queries. This makes things much more easier.<br /><br />Another thing that sometimes annoys me is the NDepend UI. The application consists of several parts that can be moved around on the screen or can be docked, much like you can do with Visual Studio. But the docking just doesn't work that great and I sometimes manage to move the parts in such a way that the UI becomes unworkable. I think it is for this reason NDepend contains a 'Reset views' option (CTRL + SHIFT + R). This misbehavior might be caused by the <a rel="external" href="http://www.devexpress.com/products/VCL/Exbars/DockingLib.xml" title="Devexpress - ExpressDocking Library ">Devexpress docking library</a> that NDepend uses internally, nevertheless I find it a bit annoying. However, I must say after discussing this with Patrick, I wasn't able to reproduce this. But again: 'Reset views' is your friend ;-).<br /><br />But even with these short comes, for me NDepend is a great tool. I have no doubt that these short comes will be solved in future releases. However, NDepend is not a tool for every developer's toolbox. The tool is especially suited for architects and lead developers that understand the importance of architecture and are working one medium to large code bases. If that's you, and haven't tried NDepend, you should.
					</div>
					
					<div id="listOfLinks"></div>
					
					<p class="info dontPrint">
						<span class="poster"><script type="text/javascript">
<!--
	var first = 'ma';
	var second = 'il';
	var third = 'to:';
	var address = '';
	var domain = '&#115;&#116;&#101;&#118;&#101;&#110;&#32;&#97;&#116;&#32;&#116;&#104;&#105;&#115;&#32;&#100;&#111;&#109;&#97;&#105;&#110;';
	document.write('<a href="');
	document.write(first+second+third);
	document.write(address);
	document.write('&#64;');
	document.write(domain);
	document.write('" title="Email Steven">');
	document.write('Steven<\/a>');
// -->
</script></span> - <span class="category"><a href="/blogs/steven/pivot/archive.php?c=.NET_General">.NET General</a>, <a href="/blogs/steven/pivot/archive.php?c=LINQ">LINQ</a></span> - 
						<span class="comments"><a href="/blogs/steven/pivot/entry.php?id=60#comm" title="Charles Strahan">one comment</a> /  <a href="/blogs/steven/pivot/entry.php?id=60#track" title="">No trackbacks</a></span> - 
						<a href="/blogs/steven/archives/archive_2009-m09.php#e60" title="Permanent link to 'NDepend' in the archives">&sect;</a> <a href="/blogs/steven/pivot/entry.php?id=60" title="Permanent link to entry 'NDepend'">&para;</a> 
					</p>
					
					<div id="NoJavascriptWarning">
						The code samples on my weblog are colorized using javascript, but
						you disabled javascript (for my website) on your browser. 
						If you're interested in viewing the posted code snippets in 
						color, please enable javascript.
					</div>
					<script type="text/javascript">
						var noScriptWarning = document.getElementById('NoJavascriptWarning');
						noScriptWarning.style.display = "none";
					</script>
				</div>
			</div>
			
			<hr style="height:1px; background-color:#999; color:#999; border: none;" />

			<p><b>one comment:</b></p>
			<div class="comments">
			<a id="comm"></a>
<a id="lastcomment"></a><p>NDepend is pretty awesome. I feel sorta bad - Mr. Smacchia gave me a copy as well, but I haven't had enough time to put together a cohesive review! One of these days...<br /><small><b>Charles Strahan</b>  (<a href='http://www.charlesstrahan.com'  title='www.charlesstrahan.com'>URL</a>) - 16 09 10 - 21:14 </small></p>

			</div>

		</div>

		<hr />
		
		<div id="footer">
			<p>&copy; 2007-2019 Steven van Deursen.<br /><span class="dontPrint"><a href="/blogs/steven/rss.xml" title="XML: RSS Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/rssbutton.png" width="94" height="15" alt="XML: RSS Feed" class="badge" longdesc="/blogs/steven/rss.xml" /></a> <a href="/blogs/steven/atom.xml" title="XML: Atom Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/atombutton.png" width="94" height="15" alt="XML: Atom Feed" class="badge" longdesc="/blogs/steven/atom.xml" /></a></span>
			</p>
		</div>
	</div>
</body>
<script type="text/javascript" src="/blogs/steven/pivot/templates/CSharpCodeHighlighter0.10.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/MSILCodeHighlighter0.1.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/X86CodeHighlighter0.1.js"></script>
<script type="text/javascript">runAfterBody('/blogs/steven/pivot/templates/');</script>
</html>