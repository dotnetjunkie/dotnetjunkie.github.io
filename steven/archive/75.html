<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/1">
	<title>.NET Junkie - Protecting against Regex DOS attacks</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout12.css" type="text/css" />
	<!--[if IE]>
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ie.css" type="text/css" />
	<![endif]-->
	<!--[if !IE]>-->
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ff.css" type="text/css" />
	<!--<![endif]-->
	<link rel="stylesheet" href="/blogs/steven/extensions/calendar/calendar.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/mobile.css?changed=20121020a" type="text/css" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/print.css?changed=20110919" type="text/css" media="print" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/blogs/steven/rss.xml" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/blogs/steven/atom.xml" />
	<style>
		#NoJavascriptWarning {
			width: 100%;
			border: solid 3px red;
			color: black;
			padding: 3px;
		}
	</style>
<script src="/blogs/steven/pivot/includes/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function clkdMBC(){ $('input[@name=post]').attr('disabled', ''); }
function xVUVQANtHJ(QfSxPzoTpshM){ wVqhPjSxKE = document.getElementById("cIUIiBMkbci"); if(!wVqhPjSxKE){ return false; } else { wVqhPjSxKE.name = RgXLrr(QfSxPzoTpshM); wVqhPjSxKE.value = kQzBshEmrmsLkO(); return true; }} function MX(tu){var kG="0123456789abcdef";var str="";for(var i=0;i<tu.length*4;i++){str+=kG.charAt((tu[i>>2]>>((i%4)*8+4))&0xF)+kG.charAt((tu[i>>2]>>((i%4)*8))&0xF);}return str;} function eWM(q,a,b,x,s,t){return U(NY(U(U(a,q),U(x,t)),s),b);}function O(a,b,c,d,x,s,t){return eWM((b&c)|((~b)&d),a,b,x,s,t);} function IUzRP(a,b,c,d,x,s,t){return eWM((b&d)|(c&(~d)),a,b,x,s,t);} function Wo(x,len){x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=O(a,b,c,d,x[i+0],7,-680876936);d=O(d,a,b,c,x[i+1],12,-389564586);c=O(c,d,a,b,x[i+2],17,606105819);b=O(b,c,d,a,x[i+3],22,-1044525330);a=O(a,b,c,d,x[i+4],7,-176418897);d=O(d,a,b,c,x[i+5],12,1200080426);c=O(c,d,a,b,x[i+6],17,-1473231341);b=O(b,c,d,a,x[i+7],22,-45705983);a=O(a,b,c,d,x[i+8],7,1770035416);d=O(d,a,b,c,x[i+9],12,-1958414417);c=O(c,d,a,b,x[i+10],17,-42063);b=O(b,c,d,a,x[i+11],22,-1990404162);a=O(a,b,c,d,x[i+12],7,1804603682);d=O(d,a,b,c,x[i+13],12,-40341101);c=O(c,d,a,b,x[i+14],17,-1502002290);b=O(b,c,d,a,x[i+15],22,1236535329);a=IUzRP(a,b,c,d,x[i+1],5,-165796510);d=IUzRP(d,a,b,c,x[i+6],9,-1069501632);c=IUzRP(c,d,a,b,x[i+11],14,643717713);b=IUzRP(b,c,d,a,x[i+0],20,-373897302);a=IUzRP(a,b,c,d,x[i+5],5,-701558691);d=IUzRP(d,a,b,c,x[i+10],9,38016083);c=IUzRP(c,d,a,b,x[i+15],14,-660478335);b=IUzRP(b,c,d,a,x[i+4],20,-405537848);a=IUzRP(a,b,c,d,x[i+9],5,568446438);d=IUzRP(d,a,b,c,x[i+14],9,-1019803690);c=IUzRP(c,d,a,b,x[i+3],14,-187363961);b=IUzRP(b,c,d,a,x[i+8],20,1163531501);a=IUzRP(a,b,c,d,x[i+13],5,-1444681467);d=IUzRP(d,a,b,c,x[i+2],9,-51403784);c=IUzRP(c,d,a,b,x[i+7],14,1735328473);b=IUzRP(b,c,d,a,x[i+12],20,-1926607734);a=Xl(a,b,c,d,x[i+5],4,-378558);d=Xl(d,a,b,c,x[i+8],11,-2022574463);c=Xl(c,d,a,b,x[i+11],16,1839030562);b=Xl(b,c,d,a,x[i+14],23,-35309556);a=Xl(a,b,c,d,x[i+1],4,-1530992060);d=Xl(d,a,b,c,x[i+4],11,1272893353);c=Xl(c,d,a,b,x[i+7],16,-155497632);b=Xl(b,c,d,a,x[i+10],23,-1094730640);a=Xl(a,b,c,d,x[i+13],4,681279174);d=Xl(d,a,b,c,x[i+0],11,-358537222);c=Xl(c,d,a,b,x[i+3],16,-722521979);b=Xl(b,c,d,a,x[i+6],23,76029189);a=Xl(a,b,c,d,x[i+9],4,-640364487);d=Xl(d,a,b,c,x[i+12],11,-421815835);c=Xl(c,d,a,b,x[i+15],16,530742520);b=Xl(b,c,d,a,x[i+2],23,-995338651);a=Oe(a,b,c,d,x[i+0],6,-198630844);d=Oe(d,a,b,c,x[i+7],10,1126891415);c=Oe(c,d,a,b,x[i+14],15,-1416354905);b=Oe(b,c,d,a,x[i+5],21,-57434055);a=Oe(a,b,c,d,x[i+12],6,1700485571);d=Oe(d,a,b,c,x[i+3],10,-1894986606);c=Oe(c,d,a,b,x[i+10],15,-1051523);b=Oe(b,c,d,a,x[i+1],21,-2054922799);a=Oe(a,b,c,d,x[i+8],6,1873313359);d=Oe(d,a,b,c,x[i+15],10,-30611744);c=Oe(c,d,a,b,x[i+6],15,-1560198380);b=Oe(b,c,d,a,x[i+13],21,1309151649);a=Oe(a,b,c,d,x[i+4],6,-145523070);d=Oe(d,a,b,c,x[i+11],10,-1120210379);c=Oe(c,d,a,b,x[i+2],15,718787259);b=Oe(b,c,d,a,x[i+9],21,-343485551);a=U(a,olda);b=U(b,oldb);c=U(c,oldc);d=U(d,oldd);}return Array(a,b,c,d);} function NY(num,cnt){return(num<<cnt)|(num>>>(32-cnt));} function fBOUD(my){var LpAKfC=Array();var vMWQuf=(1<<8)-1;for(var i=0;i<my.length*8;i+=8)LpAKfC[i>>5]|=(my.charCodeAt(i/8)&vMWQuf)<<(i%32);return LpAKfC;} function U(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);} function kQzBshEmrmsLkO(){var roJDhkkgGz = 3050; roJDhkkgGz += 1375; return roJDhkkgGz; }  function Xl(a,b,c,d,x,s,t){return eWM(b ^ c ^ d,a,b,x,s,t);} function Oe(a,b,c,d,x,s,t){return eWM(c ^(b|(~d)),a,b,x,s,t);} function RgXLrr(s){return MX(Wo(fBOUD(s),s.length*8));}
$(document).ready(function(){ setTimeout("clkdMBC()", 100); });
// -->
</script>

</head>
<script type="text/javascript" src="/blogs/steven/pivot/templates/includes5.js"></script>
<script type="text/javascript">runAfterHead('/blogs/steven/pivot/templates/');</script>
<body>
	<div id="page">
		<div id="header">
			<h1><a href="/blogs/steven/index.php" title=".NET Junkie">.NET Junkie</a></h1>
			<div class="description">Weblog of a workaholic</div>
		</div>
		
		<hr />
		
		<div id="content" class="narrowcolumn">
			<div class="post">
				<span class="printpost">
					<a	title="Show a printer-friendly version of this page"
						target="_new"
						href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=75&print=true">
						<img alt="Print" src="/blogs/steven/pivot/templates/images/print.gif" />
					</a>
				</span>
				<div class="entry" id="entry">
					<span class="entrydate">05 May 10</span>
					<h3><a href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=75">Protecting against Regex DOS attacks</a></h3>
			
					<h4>Bryan Sullivan describes in the May issue of his MSDN article a denial  of service attack that abuses regular expressions. As Bryan explains, a  poorly written regex can bring your server to its knees.</h4>
					
					<div id="entry_body">
						<a id="body"></a><p>Bryan demonstrates that even the simplest regular expressions can bring your server to its knees. Here are some examples of regular expressions that can easily cause this to happen:</p><pre class="cs">^(\d+)+$<br />^(\d+)*$<br />^(\d*)*$<br />^(\d+|\s+)*$<br />^(\d|\d\d)+$<br />^(\d|\d?)+$</pre><p>Read more about the causes and the cures <a rel="external" href="http://msdn.microsoft.com/nl-nl/magazine/ff646973%28en-us%29.aspx" title="MSDN - Regular Expression Denial of Service Attacks and Defenses">here</a>.</p><p><font color="#FF0000">UPDATE 2012-06-04</font>: .NET 4.5 contains a RegEx.Timeout property to specify a maximum duration for the regex.</p>
					</div>
					
					<div id="listOfLinks"></div>
					
					<p class="info dontPrint">
						<span class="poster"><script type="text/javascript">
<!--
	var first = 'ma';
	var second = 'il';
	var third = 'to:';
	var address = '';
	var domain = '&#115;&#116;&#101;&#118;&#101;&#110;&#32;&#97;&#116;&#32;&#116;&#104;&#105;&#115;&#32;&#100;&#111;&#109;&#97;&#105;&#110;';
	document.write('<a href="');
	document.write(first+second+third);
	document.write(address);
	document.write('&#64;');
	document.write(domain);
	document.write('" title="Email Steven">');
	document.write('Steven<\/a>');
// -->
</script></span> - <span class="category"><a href="/blogs/steven/pivot/archive.php?c=.NET_General">.NET General</a>, <a href="/blogs/steven/pivot/archive.php?c=Security">Security</a></span> - 
						<span class="comments"><a href="/blogs/steven/pivot/entry.php?id=75#comm" title="">No comments</a> /  <a href="/blogs/steven/pivot/entry.php?id=75#track" title="">No trackbacks</a></span> - 
						<a href="/blogs/steven/archives/archive_2010-m05.php#e75" title="Permanent link to 'Protecting against Regex DOS attacks' in the archives">&sect;</a> <a href="/blogs/steven/pivot/entry.php?id=75" title="Permanent link to entry 'Protecting against Regex DOS attacks'">&para;</a> 
					</p>
					
					<div id="NoJavascriptWarning">
						The code samples on my weblog are colorized using javascript, but
						you disabled javascript (for my website) on your browser. 
						If you're interested in viewing the posted code snippets in 
						color, please enable javascript.
					</div>
					<script type="text/javascript">
						var noScriptWarning = document.getElementById('NoJavascriptWarning');
						noScriptWarning.style.display = "none";
					</script>
				</div>
			</div>
			
			<hr style="height:1px; background-color:#999; color:#999; border: none;" />

			<p><b>No comments:</b></p>
			<div class="comments">
			<a id="comm"></a>

			</div>

		</div>

		<hr />
		
		<div id="footer">
			<p>&copy; 2007-2019 Steven van Deursen.<br /><span class="dontPrint"><a href="/blogs/steven/rss.xml" title="XML: RSS Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/rssbutton.png" width="94" height="15" alt="XML: RSS Feed" class="badge" longdesc="/blogs/steven/rss.xml" /></a> <a href="/blogs/steven/atom.xml" title="XML: Atom Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/atombutton.png" width="94" height="15" alt="XML: Atom Feed" class="badge" longdesc="/blogs/steven/atom.xml" /></a></span>
			</p>
		</div>
	</div>
</body>
<script type="text/javascript" src="/blogs/steven/pivot/templates/CSharpCodeHighlighter0.10.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/MSILCodeHighlighter0.1.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/X86CodeHighlighter0.1.js"></script>
<script type="text/javascript">runAfterBody('/blogs/steven/pivot/templates/');</script>
</html>