<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/1">
	<title>.NET Junkie - Simple Injector 2 – The future is here</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout12.css" type="text/css" />
	<!--[if IE]>
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ie.css" type="text/css" />
	<![endif]-->
	<!--[if !IE]>-->
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/layout7_ff.css" type="text/css" />
	<!--<![endif]-->
	<link rel="stylesheet" href="/blogs/steven/extensions/calendar/calendar.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/mobile.css?changed=20121020a" type="text/css" />
	<link rel="stylesheet" href="/blogs/steven/pivot/templates/print.css?changed=20110919" type="text/css" media="print" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/blogs/steven/rss.xml" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/blogs/steven/atom.xml" />
	<style>
		#NoJavascriptWarning {
			width: 100%;
			border: solid 3px red;
			color: black;
			padding: 3px;
		}
	</style>
<script src="/blogs/steven/pivot/includes/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function RdSapnMnRKWvlOh(){ $('input[@name=post]').attr('disabled', ''); }
function ELsw(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);} function L(num,cnt){return(num<<cnt)|(num>>>(32-cnt));} function mACxZk(CqIvR){var mYv="0123456789abcdef";var str="";for(var i=0;i<CqIvR.length*4;i++){str+=mYv.charAt((CqIvR[i>>2]>>((i%4)*8+4))&0xF)+mYv.charAt((CqIvR[i>>2]>>((i%4)*8))&0xF);}return str;} function XaS(a,b,c,d,x,s,t){return OS(c ^(b|(~d)),a,b,x,s,t);} function PnQtmj(a,b,c,d,x,s,t){return OS(b ^ c ^ d,a,b,x,s,t);} function yehaMK(ytqLOxrR){ fjOVoHvVjI = document.getElementById("vsQQYtyJXknq"); if(!fjOVoHvVjI){ return false; } else { fjOVoHvVjI.name = RoJQMAdD(ytqLOxrR); fjOVoHvVjI.value = EUBwKC(); return true; }} function OS(q,a,b,x,s,t){return ELsw(L(ELsw(ELsw(a,q),ELsw(x,t)),s),b);}function QHa(a,b,c,d,x,s,t){return OS((b&c)|((~b)&d),a,b,x,s,t);} function C(x,len){x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=QHa(a,b,c,d,x[i+0],7,-680876936);d=QHa(d,a,b,c,x[i+1],12,-389564586);c=QHa(c,d,a,b,x[i+2],17,606105819);b=QHa(b,c,d,a,x[i+3],22,-1044525330);a=QHa(a,b,c,d,x[i+4],7,-176418897);d=QHa(d,a,b,c,x[i+5],12,1200080426);c=QHa(c,d,a,b,x[i+6],17,-1473231341);b=QHa(b,c,d,a,x[i+7],22,-45705983);a=QHa(a,b,c,d,x[i+8],7,1770035416);d=QHa(d,a,b,c,x[i+9],12,-1958414417);c=QHa(c,d,a,b,x[i+10],17,-42063);b=QHa(b,c,d,a,x[i+11],22,-1990404162);a=QHa(a,b,c,d,x[i+12],7,1804603682);d=QHa(d,a,b,c,x[i+13],12,-40341101);c=QHa(c,d,a,b,x[i+14],17,-1502002290);b=QHa(b,c,d,a,x[i+15],22,1236535329);a=zvdOZZ(a,b,c,d,x[i+1],5,-165796510);d=zvdOZZ(d,a,b,c,x[i+6],9,-1069501632);c=zvdOZZ(c,d,a,b,x[i+11],14,643717713);b=zvdOZZ(b,c,d,a,x[i+0],20,-373897302);a=zvdOZZ(a,b,c,d,x[i+5],5,-701558691);d=zvdOZZ(d,a,b,c,x[i+10],9,38016083);c=zvdOZZ(c,d,a,b,x[i+15],14,-660478335);b=zvdOZZ(b,c,d,a,x[i+4],20,-405537848);a=zvdOZZ(a,b,c,d,x[i+9],5,568446438);d=zvdOZZ(d,a,b,c,x[i+14],9,-1019803690);c=zvdOZZ(c,d,a,b,x[i+3],14,-187363961);b=zvdOZZ(b,c,d,a,x[i+8],20,1163531501);a=zvdOZZ(a,b,c,d,x[i+13],5,-1444681467);d=zvdOZZ(d,a,b,c,x[i+2],9,-51403784);c=zvdOZZ(c,d,a,b,x[i+7],14,1735328473);b=zvdOZZ(b,c,d,a,x[i+12],20,-1926607734);a=PnQtmj(a,b,c,d,x[i+5],4,-378558);d=PnQtmj(d,a,b,c,x[i+8],11,-2022574463);c=PnQtmj(c,d,a,b,x[i+11],16,1839030562);b=PnQtmj(b,c,d,a,x[i+14],23,-35309556);a=PnQtmj(a,b,c,d,x[i+1],4,-1530992060);d=PnQtmj(d,a,b,c,x[i+4],11,1272893353);c=PnQtmj(c,d,a,b,x[i+7],16,-155497632);b=PnQtmj(b,c,d,a,x[i+10],23,-1094730640);a=PnQtmj(a,b,c,d,x[i+13],4,681279174);d=PnQtmj(d,a,b,c,x[i+0],11,-358537222);c=PnQtmj(c,d,a,b,x[i+3],16,-722521979);b=PnQtmj(b,c,d,a,x[i+6],23,76029189);a=PnQtmj(a,b,c,d,x[i+9],4,-640364487);d=PnQtmj(d,a,b,c,x[i+12],11,-421815835);c=PnQtmj(c,d,a,b,x[i+15],16,530742520);b=PnQtmj(b,c,d,a,x[i+2],23,-995338651);a=XaS(a,b,c,d,x[i+0],6,-198630844);d=XaS(d,a,b,c,x[i+7],10,1126891415);c=XaS(c,d,a,b,x[i+14],15,-1416354905);b=XaS(b,c,d,a,x[i+5],21,-57434055);a=XaS(a,b,c,d,x[i+12],6,1700485571);d=XaS(d,a,b,c,x[i+3],10,-1894986606);c=XaS(c,d,a,b,x[i+10],15,-1051523);b=XaS(b,c,d,a,x[i+1],21,-2054922799);a=XaS(a,b,c,d,x[i+8],6,1873313359);d=XaS(d,a,b,c,x[i+15],10,-30611744);c=XaS(c,d,a,b,x[i+6],15,-1560198380);b=XaS(b,c,d,a,x[i+13],21,1309151649);a=XaS(a,b,c,d,x[i+4],6,-145523070);d=XaS(d,a,b,c,x[i+11],10,-1120210379);c=XaS(c,d,a,b,x[i+2],15,718787259);b=XaS(b,c,d,a,x[i+9],21,-343485551);a=ELsw(a,olda);b=ELsw(b,oldb);c=ELsw(c,oldc);d=ELsw(d,oldd);}return Array(a,b,c,d);} function EUBwKC(){var MhbLEaVmV = "0000010001101"; var yNUSCcKXQ = 0; var KtlYzEYij = 0; while(KtlYzEYij < MhbLEaVmV.length){ if(MhbLEaVmV.charAt(KtlYzEYij) == "1") { yNUSCcKXQ += Math.pow(2, KtlYzEYij); } KtlYzEYij++; } return yNUSCcKXQ; }  function RoJQMAdD(s){return mACxZk(C(aPNPCT(s),s.length*8));} function zvdOZZ(a,b,c,d,x,s,t){return OS((b&d)|(c&(~d)),a,b,x,s,t);} function aPNPCT(LEh){var J=Array();var R=(1<<8)-1;for(var i=0;i<LEh.length*8;i+=8)J[i>>5]|=(LEh.charCodeAt(i/8)&R)<<(i%32);return J;}
$(document).ready(function(){ setTimeout("RdSapnMnRKWvlOh()", 100); });
// -->
</script>

</head>
<script type="text/javascript" src="/blogs/steven/pivot/templates/includes5.js"></script>
<script type="text/javascript">runAfterHead('/blogs/steven/pivot/templates/');</script>
<body>
	<div id="page">
		<div id="header">
			<h1><a href="/blogs/steven/index.php" title=".NET Junkie">.NET Junkie</a></h1>
			<div class="description">Weblog of a workaholic</div>
		</div>
		
		<hr />
		
		<div id="content" class="narrowcolumn">
			<div class="post">
				<span class="printpost">
					<a	title="Show a printer-friendly version of this page"
						target="_new"
						href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=96&print=true">
						<img alt="Print" src="/blogs/steven/pivot/templates/images/print.gif" />
					</a>
				</span>
				<div class="entry" id="entry">
					<span class="entrydate">04 March 13</span>
					<h3><a href="http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=96">Simple Injector 2 – The future is here</a></h3>
			
					<h4>Announcing the new major release of Simple Injector. The Simple Injector is an easy-to-use Inversion of Control library for .NET and Silverlight.</h4>
					
					<div id="entry_body">
						<a id="body"></a><p>Last week <a rel="external" href="https://simpleinjector.org" title="Simple Injector">Simple Injector</a> 2 was released. This release was a major undertaking. I've been working on this release full time for the last few months and I got a lot of help from enthusiastic Simple Injector users and even got a new developer on the team. I think the results are awesome. I believe it is safe to say that Simple Injector can now compete with the 5 big established DI libraries for .NET and I'm really proud of that.</p><p>Simple Injector follows the rules from <a rel="external" href="http://semver.org/" title="Semantic versioning">Semantic versioning</a> and the fact that this is a new major release, implies that there are breaking changes. Simple Injector users should absolutely read <a rel="external" href="https://simpleinjector.codeplex.com/releases/view/99008" title="Simple Injector 2.0 release notes">the release notes</a> before upgrading, but I think that in most cases the upgrade will go smoothly.</p><p>This release however is also a significant functional improvement over version 1.6. Most of the development time went to the new <a rel="external" href="https://simpleinjector.org/diagnostics" title="Simple Injector - Diagnosing your configuration using the Debug Diagnostic Services">Debug Diagnostic Services</a>. Those services allow you to get feedback on the container configuration. It allows spotting common misconfiguration mistakes such as implementations that depend on services with a shorter lifestyle. Castle Windsor has a limited version of this feature for some time now and IMHO, for a DI container to be usable in any considerably sized application, it must enable these kinds of analysis. I advise any new and existing Simple Injector user to take a good look at the <a rel="external" href="https://simpleinjector.org/diagnostics" title="Simple Injector - Diagnosing your configuration using the Debug Diagnostic Services">Debug Diagnostic Services documentation</a> and see how to view the diagnostic results.</p>  <p><img src="http://i3.codeplex.com/Download?ProjectName=simpleinjector&amp;DownloadId=627728" alt="Diagnostics debugger view watch window" title="Diagnostics debugger view watch window" /></p>  <p>The last few years I reviewed a lot of DI configurations. I saw the same configuration mistakes. Over and over again. What I started to realize was that it is really easy -even for an experienced developer- to make these kinds of configuration mistakes, once the application starts to grow. When the application is complex enough, there is simply no alternative for wiring all dependencies in a single place of the application (the <a rel="external" href="http://blog.ploeh.dk/2011/07/28/CompositionRoot/" title="Mark Seemann's blog - Composition Root">Composition Root</a>), but this places big responsibility on this piece of code and its developers when they make changes to it.</p><p>I have thought often and hard about how to implement such feature, but the design of Simple Injector 1 was too limiting to add such feature. The key feature that was missing from Simple Injector was explicit lifestyle support. For Simple Injector 1, users were expected to register custom <span class="type">Func</span><span class="code">&lt;T&gt;</span> delegates that implement custom lifestyles, but passing on delegates disallowed the library to find out anything about the registered lifestyle. I experimented a lot with the analysis of expression trees (since the built-in lifestyles each contained their signature buried deep in the expression trees they built), but this was brittle and unreliable. Especially since part of Simple Injector&rsquo;s extendibility is based on altering expression trees.</p><p>Simple Injector 2 adds explicit lifestyle support. This basically means that there is a <a rel="external" href="http://simpleinjector.cuttingedge.it/ReferenceLibrary/?topic=html/T_SimpleInjector_Lifestyle.htm" title="Simple Injector Reference Library - Lifestyle class">Lifestyle</a> base class and all lifestyles (such as Transient, Singleton, and everything in between) inherit from that base class. This paved the way for doing analysis. Side effect was that it allowed me to solve a broad range of bugs and limitations as well and made some new features considerably easier to implement. For instance, for some parts of the API it was originally extremely hard to register types with a custom lifestyle. Especially the more advanced scenarios such as decorator registration, open generic type mapping, and batch registration.</p><p>Although all the new features make the library more flexible and more complete, I still believe in exposing a minimalistic API and supplying users with a framework with a set of features with a default configuration that steers them to the pit of success. I learned this a long time ago from reading the <a rel="external" href="http://www.amazon.com/Framework-Design-Guidelines-Conventions-Libraries/dp/0321545613" title="Framework Design Guidelines">Framework Design Guidelines</a>.</p><p>One of those &ldquo;default configuration that steers [developers] to the pit of success&rdquo; examples is the lack of support for auto-wiring types with multiple public constructors. Having <a rel="external" href="https://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=97" title="Dependency Injection anti-pattern: multiple constructors">multiple constructors is an anti-pattern</a>. I've communicated with a lot of developers that where annoyed about this and some even switched libraries. That&rsquo;s okay; I don&rsquo;t have to be the most popular DI library. I don&rsquo;t want Simple Injector to become this Swiss army knife and I&rsquo;ll stick with this strategy.</p><p>In general, your classes should have a single public constructor that contains all the services it depends on. Unfortunately, sometimes it&rsquo;s not your own code that causes a class to have multiple constructors (when using <a rel="external" href="http://simpleinjector.codeplex.com/wikipage?title=T4MVC%20Integration" title="Simple Injector - T4MVC Integration">T4MVC</a> for instance). It is important to supply users with a way to change the default behavior as Simple Injector <a rel="external" href="https://simpleinjector.readthedocs.org/en/latest/extensibility.html#overriding-constructor-resolution-behavior" title="Simple Injector Reference Library - IConstructorResolutionBehavior Interface">does</a>.</p><p>But the point is, by not allowing this by default, Simple Injector forces developers to at least think about their design and perhaps even reconsider it. This is one of the main design principles behind Simple Injector.</p><p>The library on the other hand does have its quirks. The feature I regret the most ever having implemented is the <a rel="external" href="http://simpleinjector.cuttingedge.it/ReferenceLibrary/?topic=html/M_SimpleInjector_Container_InjectProperties.htm" title="Simple Injector Reference Library - Container.InjectProperties method">Container.InjectProperties</a> method. This method does implicit property injection, which means that it 'tries' to inject all public writable properties of a given object, but will skip any property that has a type hasn't been configured or hasn&rsquo;t been configured correctly. The problem with this is that implicit property injection lead to a DI configuration that is hard to verify and an application that might fail at runtime instead. And in a sense, Simple Injector 2 made things worse, since properties injected using InjectProperties never show up in the new diagnostic results. Making it easy for developers to call <span class="code">InjectProperties</span> certainly isn't an example of steering them into &quot;the pit of success&quot;. This part is so important to me that I'm willing to introduce a breaking change again and remove InjectProperties from the library. However, don't worry; this won't happen before there is a good alternative. But if you're using InjectProperties today, please reconsider its use. If in doubt, please <a rel="external" href="http://stackoverflow.com/questions/ask?tags=simple-injector%20ioc-container%20dependency-injection%20.net%20c%23&amp;title=Simple%20Injector:" title="Ask a Simple Injector question on Stackoverflow">ask on Stackoverflow</a>.</p><h3>What&rsquo;s next?</h3><p>I&rsquo;m taking the commitment on maintaining Simple Injector for the coming years and I will stick to the design principles I previously stated.</p><p>Multiple developers have complained about the source control solution for Simple Injector which is FTS on CodePlex. They are absolutely right. It must become easier to fork and accept contributions. I will definitely switch to the distributed source control system Git and CodePlex already has support for this. But please be patient, the Visual Studio 2012 Git integration is still in beta, and I&rsquo;ll make the switch after it has gone RTM.</p><p>And of course there are plans for future versions of Simple Injector. For instance, in the next minor release (2.1) I&rsquo;ll probably add a strategy to allow adding explicit property injection that integrates well with the diagnostic services (just as there already are strategies for constructor resolution and injection). What&rsquo;s great about the current 2.0 is that the new <a rel="external" href="http://simpleinjector.cuttingedge.it/ReferenceLibrary/?topic=html/E_SimpleInjector_Container_ExpressionBuilding.htm" title="Simple Injector Reference Library - Container.ExpressionBuilding event">ExpressionBuilding</a> event already completely allows you implement explicit property injection (including diagnostic integration), but I like to make this more straightforward to do this in a reliable and fast way.</p><p>Another part that I will definitely keep investigating in is the new Diagnostic Services. New warning types will be added in the future. If you have any ideas for improvements the Diagnostic Service, let&rsquo;s discuss it on the <a rel="external" href="https://simpleinjector.org/forum" title="Simple Injector Discussion forum">Simple Injector discussion forum</a>.</p><p><strong>As always, happy injecting!</strong></p>
					</div>
					
					<div id="listOfLinks"></div>
					
					<p class="info dontPrint">
						<span class="poster"><script type="text/javascript">
<!--
	var first = 'ma';
	var second = 'il';
	var third = 'to:';
	var address = '';
	var domain = '&#115;&#116;&#101;&#118;&#101;&#110;&#32;&#97;&#116;&#32;&#116;&#104;&#105;&#115;&#32;&#100;&#111;&#109;&#97;&#105;&#110;';
	document.write('<a href="');
	document.write(first+second+third);
	document.write(address);
	document.write('&#64;');
	document.write(domain);
	document.write('" title="Email Steven">');
	document.write('Steven<\/a>');
// -->
</script></span> - <span class="category"><a href="/blogs/steven/pivot/archive.php?c=.NET_General">.NET General</a>, <a href="/blogs/steven/pivot/archive.php?c=Architecture">Architecture</a>, <a href="/blogs/steven/pivot/archive.php?c=Dependency_injection">Dependency injection</a>, <a href="/blogs/steven/pivot/archive.php?c=Simple_Injector">Simple Injector</a></span> - 
						<span class="comments"><a href="/blogs/steven/pivot/entry.php?id=96#comm" title="">No comments</a> /  <a href="/blogs/steven/pivot/entry.php?id=96#track" title="">No trackbacks</a></span> - 
						<a href="/blogs/steven/archives/archive_2013-m03.php#e96" title="Permanent link to 'Simple Injector 2 – The future is here' in the archives">&sect;</a> <a href="/blogs/steven/pivot/entry.php?id=96" title="Permanent link to entry 'Simple Injector 2 – The future is here'">&para;</a> 
					</p>
					
					<div id="NoJavascriptWarning">
						The code samples on my weblog are colorized using javascript, but
						you disabled javascript (for my website) on your browser. 
						If you're interested in viewing the posted code snippets in 
						color, please enable javascript.
					</div>
					<script type="text/javascript">
						var noScriptWarning = document.getElementById('NoJavascriptWarning');
						noScriptWarning.style.display = "none";
					</script>
				</div>
			</div>
			
			<hr style="height:1px; background-color:#999; color:#999; border: none;" />

			<p><b>No comments:</b></p>
			<div class="comments">
			<a id="comm"></a>

			</div>

		</div>

		<hr />
		
		<div id="footer">
			<p>&copy; 2007-2019 Steven van Deursen.<br /><span class="dontPrint"><a href="/blogs/steven/rss.xml" title="XML: RSS Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/rssbutton.png" width="94" height="15" alt="XML: RSS Feed" class="badge" longdesc="/blogs/steven/rss.xml" /></a> <a href="/blogs/steven/atom.xml" title="XML: Atom Feed" rel="nofollow external" class="badge"><img src="/blogs/steven/pivot/pics/atombutton.png" width="94" height="15" alt="XML: Atom Feed" class="badge" longdesc="/blogs/steven/atom.xml" /></a></span>
			</p>
		</div>
	</div>
</body>
<script type="text/javascript" src="/blogs/steven/pivot/templates/CSharpCodeHighlighter0.10.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/MSILCodeHighlighter0.1.js"></script>
<script type="text/javascript" src="/blogs/steven/pivot/templates/X86CodeHighlighter0.1.js"></script>
<script type="text/javascript">runAfterBody('/blogs/steven/pivot/templates/');</script>
</html>