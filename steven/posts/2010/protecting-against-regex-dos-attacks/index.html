<!DOCTYPE html>
<html lang="en-us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
		<title>
				Protecting against Regex DOS attacks &middot; .NET Junkie - Weblog of a workaholic
		</title>
	
		
		<link rel="stylesheet" href="/steven/css/style.css">
		<link rel="stylesheet" href="/steven/css/overrides2.css">
		<link rel="stylesheet" href="/steven/css/Libre_Baskerville_400_400i_700.css">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/steven/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/steven/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/steven/images/apple-touch-icon.png">
	
		
		<link href="" rel="alternate" type="application/rss+xml" title=".NET Junkie - Weblog of a workaholic" />
	</head>
	
    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/steven/">
					<h2 class="nav-title">.NET Junkie - Weblog of a workaholic</h2>
				</a>
				<ul class="noprint">
    <li><a href="/steven/">Posts</a></li>
    <li><a href="/steven/about">About</a></li>
    <li><a href="/steven/privacy">Privacy</a></li>
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <b><span>Written by</span>
        Steven van Deursen
	</b>
        <br>
        <span>on&nbsp;</span><time datetime="2010-05-05 00:00:00 &#43;0000 UTC">May 5, 2010</time>
	<br>
	
	<span>0-minute read</span>
</div>
		<h1 class="post-title">Protecting against Regex DOS attacks</h1>



		

		

<h3 id="bryan-sullivan-describes-in-the-may-issue-of-his-msdn-article-a-denial-of-service-attack-that-abuses-regular-expressions-as-bryan-explains-a-poorly-written-regex-can-bring-your-server-to-its-knees">Bryan Sullivan describes in the May issue of his MSDN article a denial of service attack that abuses regular expressions. As Bryan explains, a poorly written regex can bring your server to its knees.</h3>

<p>Bryan demonstrates that even the simplest regular expressions can bring your server to its knees. Here are some examples of regular expressions that can easily cause this to happen:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">^(\d+)+$
^(\d+)*$
^(\d*)*$
^(\d+|\s+)*$
^(\d|\d\d)+$
^(\d|\d?)+$</code></pre></div>

<p>Read more about the causes and the cures <a href="https://msdn.microsoft.com/nl-nl/magazine/ff646973%28en-us%29.aspx">here</a>.</p>

<h4 id="update-2012-06-04-net-4-5-contains-a-regex-timeout-property-to-specify-a-maximum-duration-for-the-regex">UPDATE 2012-06-04: .NET 4.5 contains a RegEx.Timeout property to specify a maximum duration for the regex.</h4>

<h2 id="comments">Comments</h2>


		<hr />
	<p class="noprint">Comments are currently turned off for this blog post.</p>	

<hr class="noprint" />

<h2 id="buy-my-book">Buy my book</h2>

<p style="margin-right:7%">
<a href="https://mng.bz/BYNl" class="noprintlink"><img src="/steven/images/book%20cover%20smaller.png" style="float:left;margin-right:10px;margin-bottom:5px;border:0px solid" title="Dependency Injection Principles, Practices, and Patterns" alt="Dependency Injection Principles, Practices, and Patterns Cover Small" /></a>
I coauthored the book <a href="https://mng.bz/BYNl">Dependency Injection Principles, Practices, and Patterns</a>. If you're interested to learn more about DI and software design in general, consider reading my book.
</p>

	</div>

	<div class="pagination noprint">
		<a href="/steven/posts/2009/protecting-against-xml-expansion-attacks/" class="left arrow">&#8592;</a>
		<a href="/steven/posts/2010/breaking-changes-in-smtpclient-in-net40/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2020">2020</time>
			Steven van Deursen. <span class="noprint">Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.</span>
			</span>
		</footer>

    </body>
</html>
